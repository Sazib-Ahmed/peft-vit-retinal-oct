
=== DATASET RUN START: THOCT ===

[DATA] Split/Class counts:
class  AMD  DME  NOR  TOTAL
split                      
test    85   88   87    260
train  392  413  405   1210
val     84   89   87    260
[DATA] Train imbalance: min=392, max=413, ratio=1.05
[RAM] Caching split='train' images=1210 as uint8 tensors. Estimated RAM ~ 0.17 GB
[RAM] Cached 1210 images for split='train'
[RAM] Caching split='val' images=260 as uint8 tensors. Estimated RAM ~ 0.04 GB
[RAM] Cached 260 images for split='val'
[RAM] Caching split='test' images=260 as uint8 tensors. Estimated RAM ~ 0.04 GB
[RAM] Cached 260 images for split='test'
[IMB] Train class counts: [392, 413, 405]
[IMB] Class-Balanced weights (mean~1): [1.0279, 0.9766, 0.9955]
[IMB] Sampler disabled. min=392 max=413 ratio=1.05

[DATASET] THOCT
 - root: D:\AIUB\DSP\Code\Datasets\THOCT1800\THOCT1800_CLEAN_SHAONLY
 - pad_to_square: True
 - cache_in_ram: True
 - classes (3): ['AMD', 'DME', 'NOR']
 - split sizes: train=1210 val=260 test=260

[MODEL] Creating deit_base_distilled_patch16_224 + Manual LoRA (frozen=True)
[PARAMS] total=86,099,718 trainable=299,526 (0.3479%)
[IMB] Train class counts: [392, 413, 405]
[IMB] Class-Balanced weights (mean~1): [1.0279, 0.9766, 0.9955]
[IMB] Sampler disabled. min=392 max=413 ratio=1.05
[THOCT] Epoch 001/100 | lr=2.00e-05 | train_loss=1.1088 train_acc=31.65% | val_loss=1.0773 val_acc=37.31% val_macroF1=33.24% | ep_time=5.0s peakVRAM=3.64GB
[ES] New best val_loss=1.077257 -> saved runs\THOCT\deit_base_lora_frozen_3c\20251225-001106\best_model.pth
[THOCT] Epoch 002/100 | lr=3.00e-05 | train_loss=1.0650 train_acc=40.83% | val_loss=1.0302 val_acc=47.31% val_macroF1=44.25% | ep_time=4.2s peakVRAM=3.64GB
[ES] New best val_loss=1.030168 -> saved runs\THOCT\deit_base_lora_frozen_3c\20251225-001106\best_model.pth
[THOCT] Epoch 003/100 | lr=4.00e-05 | train_loss=1.0186 train_acc=52.81% | val_loss=0.9693 val_acc=61.92% val_macroF1=59.93% | ep_time=4.2s peakVRAM=3.64GB
[ES] New best val_loss=0.969342 -> saved runs\THOCT\deit_base_lora_frozen_3c\20251225-001106\best_model.pth
[THOCT] Epoch 004/100 | lr=5.00e-05 | train_loss=0.9820 train_acc=61.32% | val_loss=0.8972 val_acc=78.46% val_macroF1=77.90% | ep_time=4.2s peakVRAM=3.64GB
[ES] New best val_loss=0.897159 -> saved runs\THOCT\deit_base_lora_frozen_3c\20251225-001106\best_model.pth
[THOCT] Epoch 005/100 | lr=6.00e-05 | train_loss=0.9064 train_acc=74.63% | val_loss=0.8180 val_acc=86.92% val_macroF1=86.80% | ep_time=4.2s peakVRAM=3.64GB
[ES] New best val_loss=0.817954 -> saved runs\THOCT\deit_base_lora_frozen_3c\20251225-001106\best_model.pth
[THOCT] Epoch 006/100 | lr=7.00e-05 | train_loss=0.8301 train_acc=82.40% | val_loss=0.7322 val_acc=87.69% val_macroF1=87.60% | ep_time=4.2s peakVRAM=3.64GB
[ES] New best val_loss=0.732185 -> saved runs\THOCT\deit_base_lora_frozen_3c\20251225-001106\best_model.pth
[THOCT] Epoch 007/100 | lr=8.00e-05 | train_loss=0.7466 train_acc=87.85% | val_loss=0.6393 val_acc=92.31% val_macroF1=92.22% | ep_time=4.2s peakVRAM=3.64GB
[ES] New best val_loss=0.639335 -> saved runs\THOCT\deit_base_lora_frozen_3c\20251225-001106\best_model.pth
[THOCT] Epoch 008/100 | lr=9.00e-05 | train_loss=0.6828 train_acc=86.20% | val_loss=0.5560 val_acc=94.62% val_macroF1=94.60% | ep_time=4.2s peakVRAM=3.64GB
[ES] New best val_loss=0.555973 -> saved runs\THOCT\deit_base_lora_frozen_3c\20251225-001106\best_model.pth
[THOCT] Epoch 009/100 | lr=1.00e-04 | train_loss=0.5886 train_acc=90.17% | val_loss=0.4882 val_acc=95.00% val_macroF1=94.99% | ep_time=4.2s peakVRAM=3.64GB
[ES] New best val_loss=0.488208 -> saved runs\THOCT\deit_base_lora_frozen_3c\20251225-001106\best_model.pth
[THOCT] Epoch 010/100 | lr=1.00e-04 | train_loss=0.5287 train_acc=89.92% | val_loss=0.4253 val_acc=96.54% val_macroF1=96.55% | ep_time=4.2s peakVRAM=3.64GB
[ES] New best val_loss=0.425281 -> saved runs\THOCT\deit_base_lora_frozen_3c\20251225-001106\best_model.pth
[THOCT] Epoch 011/100 | lr=1.00e-04 | train_loss=0.5018 train_acc=90.66% | val_loss=0.3985 val_acc=96.54% val_macroF1=96.55% | ep_time=4.2s peakVRAM=3.64GB
[ES] New best val_loss=0.398549 -> saved runs\THOCT\deit_base_lora_frozen_3c\20251225-001106\best_model.pth
[THOCT] Epoch 012/100 | lr=9.99e-05 | train_loss=0.4520 train_acc=94.55% | val_loss=0.3829 val_acc=97.31% val_macroF1=97.31% | ep_time=4.2s peakVRAM=3.64GB
[ES] New best val_loss=0.382906 -> saved runs\THOCT\deit_base_lora_frozen_3c\20251225-001106\best_model.pth
[THOCT] Epoch 013/100 | lr=9.97e-05 | train_loss=0.4094 train_acc=95.95% | val_loss=0.3663 val_acc=98.08% val_macroF1=98.08% | ep_time=4.2s peakVRAM=3.64GB
[ES] New best val_loss=0.366314 -> saved runs\THOCT\deit_base_lora_frozen_3c\20251225-001106\best_model.pth
[THOCT] Epoch 014/100 | lr=9.95e-05 | train_loss=0.4454 train_acc=94.38% | val_loss=0.3724 val_acc=97.31% val_macroF1=97.31% | ep_time=4.2s peakVRAM=3.64GB
[ES] No improve 1/10
[THOCT] Epoch 015/100 | lr=9.92e-05 | train_loss=0.3879 train_acc=96.20% | val_loss=0.3561 val_acc=98.85% val_macroF1=98.86% | ep_time=4.2s peakVRAM=3.64GB
[ES] New best val_loss=0.356139 -> saved runs\THOCT\deit_base_lora_frozen_3c\20251225-001106\best_model.pth
[THOCT] Epoch 016/100 | lr=9.89e-05 | train_loss=0.4101 train_acc=95.45% | val_loss=0.3564 val_acc=98.46% val_macroF1=98.48% | ep_time=4.2s peakVRAM=3.64GB
[ES] No improve 1/10
[THOCT] Epoch 017/100 | lr=9.85e-05 | train_loss=0.4486 train_acc=93.72% | val_loss=0.3592 val_acc=97.69% val_macroF1=97.71% | ep_time=4.2s peakVRAM=3.64GB
[ES] No improve 2/10
[THOCT] Epoch 018/100 | lr=9.81e-05 | train_loss=0.4467 train_acc=92.73% | val_loss=0.3544 val_acc=98.46% val_macroF1=98.48% | ep_time=4.2s peakVRAM=3.64GB
[ES] New best val_loss=0.354431 -> saved runs\THOCT\deit_base_lora_frozen_3c\20251225-001106\best_model.pth
[THOCT] Epoch 019/100 | lr=9.76e-05 | train_loss=0.4328 train_acc=93.22% | val_loss=0.3524 val_acc=98.85% val_macroF1=98.86% | ep_time=4.2s peakVRAM=3.64GB
[ES] New best val_loss=0.352399 -> saved runs\THOCT\deit_base_lora_frozen_3c\20251225-001106\best_model.pth
[THOCT] Epoch 020/100 | lr=9.70e-05 | train_loss=0.3793 train_acc=97.11% | val_loss=0.3500 val_acc=98.85% val_macroF1=98.86% | ep_time=4.2s peakVRAM=3.64GB
[ES] New best val_loss=0.350036 -> saved runs\THOCT\deit_base_lora_frozen_3c\20251225-001106\best_model.pth
[THOCT] Epoch 021/100 | lr=9.64e-05 | train_loss=0.4133 train_acc=94.88% | val_loss=0.3443 val_acc=98.85% val_macroF1=98.86% | ep_time=4.2s peakVRAM=3.64GB
[ES] New best val_loss=0.344336 -> saved runs\THOCT\deit_base_lora_frozen_3c\20251225-001106\best_model.pth
[THOCT] Epoch 022/100 | lr=9.57e-05 | train_loss=0.3526 train_acc=98.43% | val_loss=0.3427 val_acc=98.85% val_macroF1=98.86% | ep_time=4.2s peakVRAM=3.64GB
[ES] New best val_loss=0.342725 -> saved runs\THOCT\deit_base_lora_frozen_3c\20251225-001106\best_model.pth
[THOCT] Epoch 023/100 | lr=9.49e-05 | train_loss=0.3823 train_acc=97.19% | val_loss=0.3410 val_acc=99.23% val_macroF1=99.24% | ep_time=4.2s peakVRAM=3.64GB
[ES] New best val_loss=0.341022 -> saved runs\THOCT\deit_base_lora_frozen_3c\20251225-001106\best_model.pth
[THOCT] Epoch 024/100 | lr=9.41e-05 | train_loss=0.3655 train_acc=98.18% | val_loss=0.3420 val_acc=99.23% val_macroF1=99.24% | ep_time=4.2s peakVRAM=3.64GB
[ES] No improve 1/10
[THOCT] Epoch 025/100 | lr=9.33e-05 | train_loss=0.3928 train_acc=96.03% | val_loss=0.3389 val_acc=99.23% val_macroF1=99.24% | ep_time=4.2s peakVRAM=3.64GB
[ES] New best val_loss=0.338911 -> saved runs\THOCT\deit_base_lora_frozen_3c\20251225-001106\best_model.pth
[THOCT] Epoch 026/100 | lr=9.24e-05 | train_loss=0.3521 train_acc=98.26% | val_loss=0.3374 val_acc=99.23% val_macroF1=99.24% | ep_time=4.2s peakVRAM=3.64GB
[ES] New best val_loss=0.337364 -> saved runs\THOCT\deit_base_lora_frozen_3c\20251225-001106\best_model.pth
[THOCT] Epoch 027/100 | lr=9.15e-05 | train_loss=0.3944 train_acc=95.29% | val_loss=0.3356 val_acc=99.23% val_macroF1=99.24% | ep_time=4.2s peakVRAM=3.64GB
[ES] New best val_loss=0.335649 -> saved runs\THOCT\deit_base_lora_frozen_3c\20251225-001106\best_model.pth
[THOCT] Epoch 028/100 | lr=9.05e-05 | train_loss=0.3873 train_acc=95.79% | val_loss=0.3530 val_acc=98.08% val_macroF1=98.08% | ep_time=4.2s peakVRAM=3.64GB
[ES] No improve 1/10
[THOCT] Epoch 029/100 | lr=8.94e-05 | train_loss=0.3558 train_acc=97.44% | val_loss=0.3351 val_acc=99.23% val_macroF1=99.24% | ep_time=4.2s peakVRAM=3.64GB
[ES] New best val_loss=0.335089 -> saved runs\THOCT\deit_base_lora_frozen_3c\20251225-001106\best_model.pth
[THOCT] Epoch 030/100 | lr=8.83e-05 | train_loss=0.3833 train_acc=96.94% | val_loss=0.3350 val_acc=99.62% val_macroF1=99.62% | ep_time=4.2s peakVRAM=3.64GB
[ES] New best val_loss=0.334969 -> saved runs\THOCT\deit_base_lora_frozen_3c\20251225-001106\best_model.pth
[THOCT] Epoch 031/100 | lr=8.72e-05 | train_loss=0.4018 train_acc=95.29% | val_loss=0.3348 val_acc=99.23% val_macroF1=99.24% | ep_time=4.2s peakVRAM=3.64GB
[ES] New best val_loss=0.334846 -> saved runs\THOCT\deit_base_lora_frozen_3c\20251225-001106\best_model.pth
[THOCT] Epoch 032/100 | lr=8.60e-05 | train_loss=0.3592 train_acc=98.35% | val_loss=0.3359 val_acc=99.23% val_macroF1=99.24% | ep_time=4.2s peakVRAM=3.64GB
[ES] No improve 1/10
[THOCT] Epoch 033/100 | lr=8.47e-05 | train_loss=0.3890 train_acc=96.28% | val_loss=0.3331 val_acc=99.62% val_macroF1=99.62% | ep_time=4.2s peakVRAM=3.64GB
[ES] New best val_loss=0.333127 -> saved runs\THOCT\deit_base_lora_frozen_3c\20251225-001106\best_model.pth
[THOCT] Epoch 034/100 | lr=8.35e-05 | train_loss=0.3782 train_acc=97.19% | val_loss=0.3349 val_acc=99.23% val_macroF1=99.24% | ep_time=4.2s peakVRAM=3.64GB
[ES] No improve 1/10
[THOCT] Epoch 035/100 | lr=8.21e-05 | train_loss=0.3774 train_acc=97.93% | val_loss=0.3346 val_acc=99.62% val_macroF1=99.62% | ep_time=4.2s peakVRAM=3.64GB
[ES] No improve 2/10
[THOCT] Epoch 036/100 | lr=8.08e-05 | train_loss=0.3448 train_acc=99.09% | val_loss=0.3315 val_acc=99.62% val_macroF1=99.62% | ep_time=4.2s peakVRAM=3.64GB
[ES] New best val_loss=0.331531 -> saved runs\THOCT\deit_base_lora_frozen_3c\20251225-001106\best_model.pth
[THOCT] Epoch 037/100 | lr=7.94e-05 | train_loss=0.3496 train_acc=98.68% | val_loss=0.3358 val_acc=99.62% val_macroF1=99.62% | ep_time=4.2s peakVRAM=3.64GB
[ES] No improve 1/10
[THOCT] Epoch 038/100 | lr=7.80e-05 | train_loss=0.3954 train_acc=95.95% | val_loss=0.3290 val_acc=99.62% val_macroF1=99.62% | ep_time=4.2s peakVRAM=3.64GB
[ES] New best val_loss=0.329038 -> saved runs\THOCT\deit_base_lora_frozen_3c\20251225-001106\best_model.pth
[THOCT] Epoch 039/100 | lr=7.65e-05 | train_loss=0.3623 train_acc=97.52% | val_loss=0.3299 val_acc=99.62% val_macroF1=99.62% | ep_time=4.2s peakVRAM=3.64GB
[ES] No improve 1/10
[THOCT] Epoch 040/100 | lr=7.50e-05 | train_loss=0.3723 train_acc=97.52% | val_loss=0.3304 val_acc=99.62% val_macroF1=99.62% | ep_time=4.2s peakVRAM=3.64GB
[ES] No improve 2/10
[THOCT] Epoch 041/100 | lr=7.35e-05 | train_loss=0.3326 train_acc=98.93% | val_loss=0.3306 val_acc=99.62% val_macroF1=99.62% | ep_time=4.2s peakVRAM=3.64GB
[ES] No improve 3/10
[THOCT] Epoch 042/100 | lr=7.19e-05 | train_loss=0.3433 train_acc=98.93% | val_loss=0.3289 val_acc=99.62% val_macroF1=99.62% | ep_time=4.2s peakVRAM=3.64GB
[ES] New best val_loss=0.328945 -> saved runs\THOCT\deit_base_lora_frozen_3c\20251225-001106\best_model.pth
[THOCT] Epoch 043/100 | lr=7.03e-05 | train_loss=0.3730 train_acc=97.19% | val_loss=0.3312 val_acc=99.62% val_macroF1=99.62% | ep_time=4.2s peakVRAM=3.64GB
[ES] No improve 1/10
[THOCT] Epoch 044/100 | lr=6.87e-05 | train_loss=0.3676 train_acc=96.86% | val_loss=0.3284 val_acc=99.62% val_macroF1=99.62% | ep_time=4.2s peakVRAM=3.64GB
[ES] New best val_loss=0.328417 -> saved runs\THOCT\deit_base_lora_frozen_3c\20251225-001106\best_model.pth
[THOCT] Epoch 045/100 | lr=6.71e-05 | train_loss=0.3398 train_acc=98.68% | val_loss=0.3285 val_acc=99.62% val_macroF1=99.62% | ep_time=4.2s peakVRAM=3.64GB
[ES] No improve 1/10
[THOCT] Epoch 046/100 | lr=6.55e-05 | train_loss=0.3581 train_acc=97.85% | val_loss=0.3291 val_acc=99.62% val_macroF1=99.62% | ep_time=4.2s peakVRAM=3.64GB
[ES] No improve 2/10
[THOCT] Epoch 047/100 | lr=6.38e-05 | train_loss=0.3364 train_acc=99.09% | val_loss=0.3272 val_acc=99.62% val_macroF1=99.62% | ep_time=4.2s peakVRAM=3.64GB
[ES] New best val_loss=0.327217 -> saved runs\THOCT\deit_base_lora_frozen_3c\20251225-001106\best_model.pth
[THOCT] Epoch 048/100 | lr=6.21e-05 | train_loss=0.3310 train_acc=99.17% | val_loss=0.3272 val_acc=99.62% val_macroF1=99.62% | ep_time=4.2s peakVRAM=3.64GB
[ES] New best val_loss=0.327169 -> saved runs\THOCT\deit_base_lora_frozen_3c\20251225-001106\best_model.pth
[THOCT] Epoch 049/100 | lr=6.04e-05 | train_loss=0.3396 train_acc=99.34% | val_loss=0.3269 val_acc=99.62% val_macroF1=99.62% | ep_time=4.2s peakVRAM=3.64GB
[ES] New best val_loss=0.326894 -> saved runs\THOCT\deit_base_lora_frozen_3c\20251225-001106\best_model.pth
[THOCT] Epoch 050/100 | lr=5.87e-05 | train_loss=0.3488 train_acc=98.76% | val_loss=0.3261 val_acc=99.62% val_macroF1=99.62% | ep_time=4.2s peakVRAM=3.64GB
[ES] New best val_loss=0.326063 -> saved runs\THOCT\deit_base_lora_frozen_3c\20251225-001106\best_model.pth
[THOCT] Epoch 051/100 | lr=5.70e-05 | train_loss=0.3422 train_acc=98.68% | val_loss=0.3259 val_acc=99.62% val_macroF1=99.62% | ep_time=4.2s peakVRAM=3.64GB
[ES] New best val_loss=0.325939 -> saved runs\THOCT\deit_base_lora_frozen_3c\20251225-001106\best_model.pth
[THOCT] Epoch 052/100 | lr=5.52e-05 | train_loss=0.3354 train_acc=99.09% | val_loss=0.3255 val_acc=99.62% val_macroF1=99.62% | ep_time=4.2s peakVRAM=3.64GB
[ES] New best val_loss=0.325539 -> saved runs\THOCT\deit_base_lora_frozen_3c\20251225-001106\best_model.pth
[THOCT] Epoch 053/100 | lr=5.35e-05 | train_loss=0.3714 train_acc=96.61% | val_loss=0.3269 val_acc=99.62% val_macroF1=99.62% | ep_time=4.2s peakVRAM=3.64GB
[ES] No improve 1/10
[THOCT] Epoch 054/100 | lr=5.17e-05 | train_loss=0.3602 train_acc=98.02% | val_loss=0.3267 val_acc=99.62% val_macroF1=99.62% | ep_time=4.2s peakVRAM=3.64GB
[ES] No improve 2/10
[THOCT] Epoch 055/100 | lr=5.00e-05 | train_loss=0.3337 train_acc=99.01% | val_loss=0.3249 val_acc=99.62% val_macroF1=99.62% | ep_time=4.2s peakVRAM=3.64GB
[ES] New best val_loss=0.324934 -> saved runs\THOCT\deit_base_lora_frozen_3c\20251225-001106\best_model.pth
[THOCT] Epoch 056/100 | lr=4.83e-05 | train_loss=0.3724 train_acc=97.19% | val_loss=0.3256 val_acc=99.62% val_macroF1=99.62% | ep_time=4.2s peakVRAM=3.64GB
[ES] No improve 1/10
[THOCT] Epoch 057/100 | lr=4.65e-05 | train_loss=0.3448 train_acc=98.60% | val_loss=0.3244 val_acc=99.62% val_macroF1=99.62% | ep_time=4.2s peakVRAM=3.64GB
[ES] New best val_loss=0.324421 -> saved runs\THOCT\deit_base_lora_frozen_3c\20251225-001106\best_model.pth
[THOCT] Epoch 058/100 | lr=4.48e-05 | train_loss=0.3513 train_acc=98.26% | val_loss=0.3255 val_acc=99.62% val_macroF1=99.62% | ep_time=4.2s peakVRAM=3.64GB
[ES] No improve 1/10
[THOCT] Epoch 059/100 | lr=4.30e-05 | train_loss=0.3525 train_acc=98.26% | val_loss=0.3255 val_acc=99.62% val_macroF1=99.62% | ep_time=4.2s peakVRAM=3.64GB
[ES] No improve 2/10
[THOCT] Epoch 060/100 | lr=4.13e-05 | train_loss=0.3410 train_acc=98.84% | val_loss=0.3254 val_acc=99.62% val_macroF1=99.62% | ep_time=4.2s peakVRAM=3.64GB
[ES] No improve 3/10
[THOCT] Epoch 061/100 | lr=3.96e-05 | train_loss=0.3473 train_acc=98.43% | val_loss=0.3269 val_acc=99.62% val_macroF1=99.62% | ep_time=4.2s peakVRAM=3.64GB
[ES] No improve 4/10
[THOCT] Epoch 062/100 | lr=3.79e-05 | train_loss=0.3627 train_acc=97.60% | val_loss=0.3246 val_acc=99.62% val_macroF1=99.62% | ep_time=4.2s peakVRAM=3.64GB
[ES] No improve 5/10
[THOCT] Epoch 063/100 | lr=3.62e-05 | train_loss=0.3461 train_acc=98.02% | val_loss=0.3241 val_acc=99.62% val_macroF1=99.62% | ep_time=4.2s peakVRAM=3.64GB
[ES] New best val_loss=0.324058 -> saved runs\THOCT\deit_base_lora_frozen_3c\20251225-001106\best_model.pth
[THOCT] Epoch 064/100 | lr=3.45e-05 | train_loss=0.3493 train_acc=98.76% | val_loss=0.3252 val_acc=99.62% val_macroF1=99.62% | ep_time=4.2s peakVRAM=3.64GB
[ES] No improve 1/10
[THOCT] Epoch 065/100 | lr=3.29e-05 | train_loss=0.3276 train_acc=99.34% | val_loss=0.3237 val_acc=99.62% val_macroF1=99.62% | ep_time=4.2s peakVRAM=3.64GB
[ES] New best val_loss=0.323743 -> saved runs\THOCT\deit_base_lora_frozen_3c\20251225-001106\best_model.pth
[THOCT] Epoch 066/100 | lr=3.13e-05 | train_loss=0.3549 train_acc=97.69% | val_loss=0.3230 val_acc=99.62% val_macroF1=99.62% | ep_time=4.2s peakVRAM=3.64GB
[ES] New best val_loss=0.322958 -> saved runs\THOCT\deit_base_lora_frozen_3c\20251225-001106\best_model.pth
[THOCT] Epoch 067/100 | lr=2.97e-05 | train_loss=0.3455 train_acc=98.43% | val_loss=0.3246 val_acc=99.62% val_macroF1=99.62% | ep_time=4.2s peakVRAM=3.64GB
[ES] No improve 1/10
[THOCT] Epoch 068/100 | lr=2.81e-05 | train_loss=0.3494 train_acc=98.18% | val_loss=0.3238 val_acc=99.62% val_macroF1=99.62% | ep_time=4.2s peakVRAM=3.64GB
[ES] No improve 2/10
[THOCT] Epoch 069/100 | lr=2.65e-05 | train_loss=0.3391 train_acc=98.68% | val_loss=0.3237 val_acc=99.62% val_macroF1=99.62% | ep_time=4.2s peakVRAM=3.64GB
[ES] No improve 3/10
[THOCT] Epoch 070/100 | lr=2.50e-05 | train_loss=0.3355 train_acc=98.93% | val_loss=0.3233 val_acc=99.62% val_macroF1=99.62% | ep_time=4.2s peakVRAM=3.64GB
[ES] No improve 4/10
[THOCT] Epoch 071/100 | lr=2.35e-05 | train_loss=0.3356 train_acc=98.68% | val_loss=0.3241 val_acc=99.62% val_macroF1=99.62% | ep_time=4.2s peakVRAM=3.64GB
[ES] No improve 5/10
[THOCT] Epoch 072/100 | lr=2.20e-05 | train_loss=0.3237 train_acc=99.42% | val_loss=0.3235 val_acc=99.62% val_macroF1=99.62% | ep_time=4.2s peakVRAM=3.64GB
[ES] No improve 6/10
[THOCT] Epoch 073/100 | lr=2.06e-05 | train_loss=0.3304 train_acc=99.01% | val_loss=0.3236 val_acc=99.62% val_macroF1=99.62% | ep_time=4.2s peakVRAM=3.64GB
[ES] No improve 7/10
[THOCT] Epoch 074/100 | lr=1.92e-05 | train_loss=0.3648 train_acc=97.52% | val_loss=0.3239 val_acc=99.62% val_macroF1=99.62% | ep_time=4.2s peakVRAM=3.64GB
[ES] No improve 8/10
[THOCT] Epoch 075/100 | lr=1.79e-05 | train_loss=0.3506 train_acc=98.10% | val_loss=0.3234 val_acc=99.62% val_macroF1=99.62% | ep_time=4.2s peakVRAM=3.64GB
[ES] No improve 9/10
[THOCT] Epoch 076/100 | lr=1.65e-05 | train_loss=0.3931 train_acc=95.45% | val_loss=0.3230 val_acc=99.62% val_macroF1=99.62% | ep_time=4.2s peakVRAM=3.64GB
[ES] No improve 10/10
[THOCT] Early stopping triggered.
[CAL] Fitting temperature scaling on VAL set...
[CAL] Learned temperature T = 0.4393

------------------------------------------------------------------------------------------
[THOCT] TEST classification report (uncalibrated)
------------------------------------------------------------------------------------------
              precision    recall  f1-score   support

         AMD     0.9881    0.9765    0.9822        85
         DME     0.9775    0.9886    0.9831        88
         NOR     1.0000    1.0000    1.0000        87

    accuracy                         0.9885       260
   macro avg     0.9885    0.9884    0.9884       260
weighted avg     0.9885    0.9885    0.9885       260


==========================================================================================
[THOCT] TEST summary (uncalibrated): Acc=98.85% MacroF1=98.84% ECE=0.0889 NLL=0.1007 Brier=0.0272
[THOCT] Macro-AUC=0.9999
[THOCT] TEMP-SCALED (T=0.439): ECE=0.0168 NLL=0.0222 Brier=0.0118
[THOCT] Params trainable: 299,526 (0.3479%)
[THOCT] Adapter-only size: 1.15 MB
[THOCT] Inference latency (B=1): 11.185 ms/img (89.4 imgs/s), peakVRAM=0.35GB
[THOCT] Inference throughput (B=64): 859.9 imgs/s, peakVRAM=0.67GB
[THOCT] Outputs saved in: runs\THOCT\deit_base_lora_frozen_3c\20251225-001106
==========================================================================================

