
=== DATASET RUN START: Srinivasan_2014 ===

[DATA] Split/Class counts:
class  AMD  DME  NORMAL  TOTAL
split                         
test   109  165     211    485
train  506  770     985   2261
val    108  166     211    485
[DATA] Train imbalance: min=506, max=985, ratio=1.95
[RAM] Caching split='train' images=2261 as uint8 tensors. Estimated RAM ~ 0.32 GB
[RAM] Cached 2261 images for split='train'
[RAM] Caching split='val' images=485 as uint8 tensors. Estimated RAM ~ 0.07 GB
[RAM] Cached 485 images for split='val'
[RAM] Caching split='test' images=485 as uint8 tensors. Estimated RAM ~ 0.07 GB
[RAM] Cached 485 images for split='test'
[IMB] Train class counts: [506, 770, 985]
[IMB] Class-Balanced weights (mean~1): [1.3687, 0.9113, 0.72]
[IMB] Sampler disabled. min=506 max=985 ratio=1.95

[DATASET] Srinivasan_2014
 - root: D:\AIUB\DSP\Code\Datasets\Srinivasan_2014\Srinivasan_2014_CLEAN_SHAONLY
 - pad_to_square: True
 - cache_in_ram: True
 - classes (3): ['AMD', 'DME', 'NORMAL']
 - split sizes: train=2261 val=485 test=485

[MODEL] Creating efficientnet_b0 (FULL fine-tuning, unfrozen)
[PARAMS] total=4,011,391 trainable=4,011,391 (100.00%)
[IMB] Train class counts: [506, 770, 985]
[IMB] Class-Balanced weights (mean~1): [1.3687, 0.9113, 0.72]
[IMB] Sampler disabled. min=506 max=985 ratio=1.95
[Srinivasan_2014] Epoch 001/100 | lr=1.00e-04 | train_loss=2.3761 train_acc=48.65% | val_loss=2.5087 val_acc=67.01% val_macroF1=61.84% | ep_time=6.1s peakVRAM=2.79GB
[ES] New best val_loss=2.508712 -> saved runs\Srinivasan_2014\efficientnetb0_fullft_3c\20251228-142321\best_model.pth
[Srinivasan_2014] Epoch 002/100 | lr=1.50e-04 | train_loss=1.1130 train_acc=77.93% | val_loss=0.9310 val_acc=88.66% val_macroF1=87.77% | ep_time=3.3s peakVRAM=2.79GB
[ES] New best val_loss=0.930985 -> saved runs\Srinivasan_2014\efficientnetb0_fullft_3c\20251228-142321\best_model.pth
[Srinivasan_2014] Epoch 003/100 | lr=2.00e-04 | train_loss=0.8506 train_acc=85.05% | val_loss=0.8018 val_acc=89.07% val_macroF1=88.11% | ep_time=3.2s peakVRAM=2.79GB
[ES] New best val_loss=0.801807 -> saved runs\Srinivasan_2014\efficientnetb0_fullft_3c\20251228-142321\best_model.pth
[Srinivasan_2014] Epoch 004/100 | lr=2.50e-04 | train_loss=0.7602 train_acc=85.40% | val_loss=0.6428 val_acc=92.78% val_macroF1=91.35% | ep_time=3.3s peakVRAM=2.79GB
[ES] New best val_loss=0.642782 -> saved runs\Srinivasan_2014\efficientnetb0_fullft_3c\20251228-142321\best_model.pth
[Srinivasan_2014] Epoch 005/100 | lr=3.00e-04 | train_loss=0.6797 train_acc=87.31% | val_loss=0.6007 val_acc=88.04% val_macroF1=87.58% | ep_time=3.3s peakVRAM=2.79GB
[ES] New best val_loss=0.600678 -> saved runs\Srinivasan_2014\efficientnetb0_fullft_3c\20251228-142321\best_model.pth
[Srinivasan_2014] Epoch 006/100 | lr=3.50e-04 | train_loss=0.6092 train_acc=88.81% | val_loss=0.5346 val_acc=95.67% val_macroF1=95.31% | ep_time=3.3s peakVRAM=2.79GB
[ES] New best val_loss=0.534598 -> saved runs\Srinivasan_2014\efficientnetb0_fullft_3c\20251228-142321\best_model.pth
[Srinivasan_2014] Epoch 007/100 | lr=4.00e-04 | train_loss=0.4928 train_acc=93.28% | val_loss=0.4270 val_acc=97.32% val_macroF1=97.05% | ep_time=3.3s peakVRAM=2.79GB
[ES] New best val_loss=0.426954 -> saved runs\Srinivasan_2014\efficientnetb0_fullft_3c\20251228-142321\best_model.pth
[Srinivasan_2014] Epoch 008/100 | lr=4.50e-04 | train_loss=0.4439 train_acc=94.87% | val_loss=0.4154 val_acc=98.56% val_macroF1=98.74% | ep_time=3.5s peakVRAM=2.79GB
[ES] New best val_loss=0.415423 -> saved runs\Srinivasan_2014\efficientnetb0_fullft_3c\20251228-142321\best_model.pth
[Srinivasan_2014] Epoch 009/100 | lr=5.00e-04 | train_loss=0.3966 train_acc=97.35% | val_loss=0.6528 val_acc=84.74% val_macroF1=82.44% | ep_time=3.3s peakVRAM=2.79GB
[ES] No improve 1/10
[Srinivasan_2014] Epoch 010/100 | lr=5.00e-04 | train_loss=0.3670 train_acc=97.79% | val_loss=0.3443 val_acc=100.00% val_macroF1=100.00% | ep_time=3.3s peakVRAM=2.79GB
[ES] New best val_loss=0.344336 -> saved runs\Srinivasan_2014\efficientnetb0_fullft_3c\20251228-142321\best_model.pth
[Srinivasan_2014] Epoch 011/100 | lr=5.00e-04 | train_loss=0.3449 train_acc=98.98% | val_loss=0.3382 val_acc=100.00% val_macroF1=100.00% | ep_time=3.3s peakVRAM=2.79GB
[ES] New best val_loss=0.338166 -> saved runs\Srinivasan_2014\efficientnetb0_fullft_3c\20251228-142321\best_model.pth
[Srinivasan_2014] Epoch 012/100 | lr=4.99e-04 | train_loss=0.3419 train_acc=98.85% | val_loss=0.3494 val_acc=99.18% val_macroF1=99.23% | ep_time=3.3s peakVRAM=2.79GB
[ES] No improve 1/10
[Srinivasan_2014] Epoch 013/100 | lr=4.99e-04 | train_loss=0.3436 train_acc=98.67% | val_loss=0.3387 val_acc=99.79% val_macroF1=99.77% | ep_time=3.4s peakVRAM=2.79GB
[ES] No improve 2/10
[Srinivasan_2014] Epoch 014/100 | lr=4.98e-04 | train_loss=0.3295 train_acc=99.16% | val_loss=0.3331 val_acc=100.00% val_macroF1=100.00% | ep_time=3.3s peakVRAM=2.79GB
[ES] New best val_loss=0.333079 -> saved runs\Srinivasan_2014\efficientnetb0_fullft_3c\20251228-142321\best_model.pth
[Srinivasan_2014] Epoch 015/100 | lr=4.96e-04 | train_loss=0.3181 train_acc=99.82% | val_loss=0.3684 val_acc=97.94% val_macroF1=98.14% | ep_time=3.3s peakVRAM=2.79GB
[ES] No improve 1/10
[Srinivasan_2014] Epoch 016/100 | lr=4.95e-04 | train_loss=0.3226 train_acc=99.60% | val_loss=0.3436 val_acc=99.38% val_macroF1=99.46% | ep_time=3.3s peakVRAM=2.79GB
[ES] No improve 2/10
[Srinivasan_2014] Epoch 017/100 | lr=4.93e-04 | train_loss=0.3318 train_acc=99.20% | val_loss=0.3436 val_acc=99.79% val_macroF1=99.75% | ep_time=3.3s peakVRAM=2.79GB
[ES] No improve 3/10
[Srinivasan_2014] Epoch 018/100 | lr=4.90e-04 | train_loss=0.3261 train_acc=99.38% | val_loss=0.3366 val_acc=99.79% val_macroF1=99.82% | ep_time=3.4s peakVRAM=2.79GB
[ES] No improve 4/10
[Srinivasan_2014] Epoch 019/100 | lr=4.88e-04 | train_loss=0.3230 train_acc=99.38% | val_loss=0.3337 val_acc=100.00% val_macroF1=100.00% | ep_time=3.3s peakVRAM=2.79GB
[ES] No improve 5/10
[Srinivasan_2014] Epoch 020/100 | lr=4.85e-04 | train_loss=0.3390 train_acc=98.85% | val_loss=0.3409 val_acc=99.59% val_macroF1=99.64% | ep_time=3.3s peakVRAM=2.79GB
[ES] No improve 6/10
[Srinivasan_2014] Epoch 021/100 | lr=4.82e-04 | train_loss=0.3497 train_acc=98.01% | val_loss=0.3319 val_acc=100.00% val_macroF1=100.00% | ep_time=3.3s peakVRAM=2.79GB
[ES] New best val_loss=0.331903 -> saved runs\Srinivasan_2014\efficientnetb0_fullft_3c\20251228-142321\best_model.pth
[Srinivasan_2014] Epoch 022/100 | lr=4.78e-04 | train_loss=0.3170 train_acc=99.73% | val_loss=0.3308 val_acc=100.00% val_macroF1=100.00% | ep_time=3.3s peakVRAM=2.79GB
[ES] New best val_loss=0.330829 -> saved runs\Srinivasan_2014\efficientnetb0_fullft_3c\20251228-142321\best_model.pth
[Srinivasan_2014] Epoch 023/100 | lr=4.75e-04 | train_loss=0.3348 train_acc=98.67% | val_loss=0.3318 val_acc=100.00% val_macroF1=100.00% | ep_time=3.3s peakVRAM=2.79GB
[ES] No improve 1/10
[Srinivasan_2014] Epoch 024/100 | lr=4.71e-04 | train_loss=0.3206 train_acc=99.43% | val_loss=0.3317 val_acc=100.00% val_macroF1=100.00% | ep_time=3.3s peakVRAM=2.79GB
[ES] No improve 2/10
[Srinivasan_2014] Epoch 025/100 | lr=4.67e-04 | train_loss=0.3164 train_acc=99.78% | val_loss=0.3313 val_acc=100.00% val_macroF1=100.00% | ep_time=3.5s peakVRAM=2.79GB
[ES] No improve 3/10
[Srinivasan_2014] Epoch 026/100 | lr=4.62e-04 | train_loss=0.3291 train_acc=99.12% | val_loss=0.3336 val_acc=100.00% val_macroF1=100.00% | ep_time=3.4s peakVRAM=2.79GB
[ES] No improve 4/10
[Srinivasan_2014] Epoch 027/100 | lr=4.57e-04 | train_loss=0.3428 train_acc=98.41% | val_loss=0.3381 val_acc=99.79% val_macroF1=99.75% | ep_time=3.3s peakVRAM=2.79GB
[ES] No improve 5/10
[Srinivasan_2014] Epoch 028/100 | lr=4.52e-04 | train_loss=0.3215 train_acc=99.60% | val_loss=0.3310 val_acc=100.00% val_macroF1=100.00% | ep_time=3.3s peakVRAM=2.79GB
[ES] No improve 6/10
[Srinivasan_2014] Epoch 029/100 | lr=4.47e-04 | train_loss=0.3191 train_acc=99.56% | val_loss=0.3309 val_acc=100.00% val_macroF1=100.00% | ep_time=3.4s peakVRAM=2.79GB
[ES] No improve 7/10
[Srinivasan_2014] Epoch 030/100 | lr=4.42e-04 | train_loss=0.3197 train_acc=99.65% | val_loss=0.3307 val_acc=100.00% val_macroF1=100.00% | ep_time=3.4s peakVRAM=2.79GB
[ES] New best val_loss=0.330718 -> saved runs\Srinivasan_2014\efficientnetb0_fullft_3c\20251228-142321\best_model.pth
[Srinivasan_2014] Epoch 031/100 | lr=4.36e-04 | train_loss=0.3151 train_acc=99.87% | val_loss=0.3317 val_acc=100.00% val_macroF1=100.00% | ep_time=3.3s peakVRAM=2.79GB
[ES] No improve 1/10
[Srinivasan_2014] Epoch 032/100 | lr=4.30e-04 | train_loss=0.3146 train_acc=99.91% | val_loss=0.3314 val_acc=100.00% val_macroF1=100.00% | ep_time=3.4s peakVRAM=2.79GB
[ES] No improve 2/10
[Srinivasan_2014] Epoch 033/100 | lr=4.24e-04 | train_loss=0.3160 train_acc=99.73% | val_loss=0.3406 val_acc=99.38% val_macroF1=99.46% | ep_time=3.6s peakVRAM=2.79GB
[ES] No improve 3/10
[Srinivasan_2014] Epoch 034/100 | lr=4.17e-04 | train_loss=0.3201 train_acc=99.51% | val_loss=0.3314 val_acc=100.00% val_macroF1=100.00% | ep_time=3.3s peakVRAM=2.79GB
[ES] No improve 4/10
[Srinivasan_2014] Epoch 035/100 | lr=4.11e-04 | train_loss=0.3145 train_acc=99.73% | val_loss=0.3306 val_acc=100.00% val_macroF1=100.00% | ep_time=3.3s peakVRAM=2.79GB
[ES] New best val_loss=0.330586 -> saved runs\Srinivasan_2014\efficientnetb0_fullft_3c\20251228-142321\best_model.pth
[Srinivasan_2014] Epoch 036/100 | lr=4.04e-04 | train_loss=0.3178 train_acc=99.73% | val_loss=0.3307 val_acc=100.00% val_macroF1=100.00% | ep_time=3.3s peakVRAM=2.79GB
[ES] No improve 1/10
[Srinivasan_2014] Epoch 037/100 | lr=3.97e-04 | train_loss=0.3185 train_acc=99.60% | val_loss=0.3314 val_acc=100.00% val_macroF1=100.00% | ep_time=3.3s peakVRAM=2.79GB
[ES] No improve 2/10
[Srinivasan_2014] Epoch 038/100 | lr=3.90e-04 | train_loss=0.3227 train_acc=99.43% | val_loss=0.3506 val_acc=98.97% val_macroF1=98.95% | ep_time=3.3s peakVRAM=2.79GB
[ES] No improve 3/10
[Srinivasan_2014] Epoch 039/100 | lr=3.82e-04 | train_loss=0.3191 train_acc=99.51% | val_loss=0.3306 val_acc=100.00% val_macroF1=100.00% | ep_time=3.3s peakVRAM=2.79GB
[ES] No improve 4/10
[Srinivasan_2014] Epoch 040/100 | lr=3.75e-04 | train_loss=0.3165 train_acc=99.78% | val_loss=0.3329 val_acc=100.00% val_macroF1=100.00% | ep_time=3.3s peakVRAM=2.79GB
[ES] No improve 5/10
[Srinivasan_2014] Epoch 041/100 | lr=3.67e-04 | train_loss=0.3433 train_acc=98.23% | val_loss=0.3398 val_acc=99.59% val_macroF1=99.57% | ep_time=3.3s peakVRAM=2.79GB
[ES] No improve 6/10
[Srinivasan_2014] Epoch 042/100 | lr=3.60e-04 | train_loss=0.3185 train_acc=99.56% | val_loss=0.3312 val_acc=100.00% val_macroF1=100.00% | ep_time=3.3s peakVRAM=2.79GB
[ES] No improve 7/10
[Srinivasan_2014] Epoch 043/100 | lr=3.52e-04 | train_loss=0.3265 train_acc=99.16% | val_loss=0.3312 val_acc=100.00% val_macroF1=100.00% | ep_time=3.3s peakVRAM=2.79GB
[ES] No improve 8/10
[Srinivasan_2014] Epoch 044/100 | lr=3.44e-04 | train_loss=0.3178 train_acc=99.78% | val_loss=0.3314 val_acc=100.00% val_macroF1=100.00% | ep_time=3.3s peakVRAM=2.79GB
[ES] No improve 9/10
[Srinivasan_2014] Epoch 045/100 | lr=3.36e-04 | train_loss=0.3149 train_acc=99.82% | val_loss=0.3309 val_acc=100.00% val_macroF1=100.00% | ep_time=3.4s peakVRAM=2.79GB
[ES] No improve 10/10
[Srinivasan_2014] Early stopping triggered.
[CAL] Fitting temperature scaling on VAL set...
[CAL] Learned temperature T = 0.2781

------------------------------------------------------------------------------------------
[Srinivasan_2014] TEST classification report (uncalibrated)
------------------------------------------------------------------------------------------
              precision    recall  f1-score   support

         AMD     1.0000    1.0000    1.0000       109
         DME     1.0000    0.9939    0.9970       165
      NORMAL     0.9953    1.0000    0.9976       211

    accuracy                         0.9979       485
   macro avg     0.9984    0.9980    0.9982       485
weighted avg     0.9979    0.9979    0.9979       485


==========================================================================================
[Srinivasan_2014] TEST summary (uncalibrated): Acc=99.79% MacroF1=99.82% ECE=0.0805 NLL=0.0904 Brier=0.0139
[Srinivasan_2014] Macro-AUC=1.0000
[Srinivasan_2014] TEMP-SCALED (T=0.278): ECE=0.0019 NLL=0.0200 Brier=0.0040
[Srinivasan_2014] Params trainable: 4,011,391 (100.00%)
[Srinivasan_2014] Inference latency (B=1): 16.444 ms/img (60.8 imgs/s), peakVRAM=0.06GB
[Srinivasan_2014] Inference throughput (B=64): 3659.2 imgs/s, peakVRAM=0.45GB
[Srinivasan_2014] Outputs saved in: runs\Srinivasan_2014\efficientnetb0_fullft_3c\20251228-142321
==========================================================================================

