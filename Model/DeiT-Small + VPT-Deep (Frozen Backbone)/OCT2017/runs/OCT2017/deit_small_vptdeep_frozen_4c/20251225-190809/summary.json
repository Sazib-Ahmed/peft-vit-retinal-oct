{
  "dataset": "OCT2017",
  "root": "D:\\AIUB\\DSP\\Code\\Datasets\\ZhangLabData\\OCT2017_CLEAN_SHAONLY",
  "classes": [
    "CNV",
    "DME",
    "DRUSEN",
    "NORMAL"
  ],
  "model": "deit_small_distilled_patch16_224",
  "peft": "VPT-Deep (per-layer prompts) frozen backbone",
  "vpt": {
    "num_prompts_per_layer": 20,
    "prompt_dropout": 0.0,
    "init_std": 0.02
  },
  "params": {
    "total": 21761672,
    "trainable": 95240,
    "trainable_pct": 0.4376501952607318
  },
  "storage": {
    "best_model_path": "runs\\OCT2017\\deit_small_vptdeep_frozen_4c\\20251225-190809\\best_model.pth",
    "adapter_only_enabled": true,
    "adapter_only_bytes": 386721,
    "adapter_only_mb": 0.3688058853149414
  },
  "training": {
    "epochs_ran": 40,
    "best_val_loss": 0.4956393837928772,
    "best_val_macro_f1": 0.9492539827221631,
    "total_train_time_sec": 5746.060760259628,
    "mean_epoch_time_sec": 138.04023796319962,
    "peak_train_vram_gb": 1.734304428100586
  },
  "test_uncalibrated": {
    "acc": 0.896,
    "macro_f1": 0.8959165356311541,
    "macro_auc": 0.9957253333333334,
    "ece": 0.08502405136823654,
    "nll": 0.3109373152256012,
    "brier": 0.15415475545484966
  },
  "test_temp_scaled": {
    "enabled": true,
    "T": 0.5476254820823669,
    "ece": 0.06101900130510332,
    "nll": 0.29718244075775146,
    "brier": 0.1649000557257936
  },
  "inference_benchmark": {
    "latency_batch1": {
      "batch": 1,
      "mean_batch_ms": 13.410318666137755,
      "std_batch_ms": 0.5415757978446478,
      "ms_per_img": 13.410318666137755,
      "imgs_per_s": 74.56944349317281,
      "peak_vram_gb": 0.10320281982421875
    },
    "throughput_batchN": {
      "batch": 64,
      "mean_batch_ms": 30.075786667487893,
      "std_batch_ms": 0.5423672037384287,
      "ms_per_img": 0.46993416667949833,
      "imgs_per_s": 2127.957639398486,
      "peak_vram_gb": 0.318662166595459
    }
  }
}