{
  "meta": {
    "created_utc": "2025-12-27T04:08:50Z",
    "search_root": "D:\\AIUB\\DSP\\Code\\Models\\ViT + LoRA (frozen)",
    "output_file": "D:\\AIUB\\DSP\\Code\\Models\\ViT + LoRA (frozen)\\ViT + LoRA (frozen)_combined_summaries.json",
    "summary_files_found": 5,
    "runs_loaded": 5,
    "runs_failed": 0,
    "note": "Each run includes (source, facts, raw). facts is normalized for AI; raw preserves original Summary.json."
  },
  "runs": [
    {
      "source": {
        "relative_path": "OCT2017/runs/OCT2017/deit_small_lora_frozen_4c/20251225-081806/summary.json",
        "absolute_path": "D:\\AIUB\\DSP\\Code\\Models\\ViT + LoRA (frozen)\\OCT2017\\runs\\OCT2017\\deit_small_lora_frozen_4c\\20251225-081806\\summary.json"
      },
      "facts": {
        "dataset": "OCT2017",
        "root": "D:\\AIUB\\DSP\\Code\\Datasets\\ZhangLabData\\OCT2017_CLEAN_SHAONLY",
        "model": "deit_small_distilled_patch16_224",
        "peft": "Manual LoRA into qkv (frozen backbone)",
        "classes": [
          "CNV",
          "DME",
          "DRUSEN",
          "NORMAL"
        ],
        "num_classes": 4,
        "lora": {
          "r": 8,
          "alpha": 16,
          "dropout": 0.1,
          "merged_for_timing": true
        },
        "params": {
          "total": 21816968,
          "trainable": 150536,
          "trainable_pct": 0.6899950533914704
        },
        "storage": {
          "best_model_path": "runs\\OCT2017\\deit_small_lora_frozen_4c\\20251225-081806\\best_model.pth",
          "adapter_only_enabled": true,
          "adapter_only_mb": 0.5830011367797852,
          "adapter_only_bytes": 611321
        },
        "training": {
          "epochs_ran": 100,
          "best_val_loss": 0.4697935613580405,
          "best_val_macro_f1": 0.9708529679182543,
          "total_train_time_sec": 13304.88613653183,
          "mean_epoch_time_sec": 127.12739509820938,
          "peak_train_vram_gb": 1.7478580474853516
        },
        "test_uncalibrated": {
          "acc": 0.92,
          "macro_f1": 0.9185539959606476,
          "macro_auc": 0.9926173333333335,
          "ece": 0.08643192729353905,
          "nll": 0.2727710008621216,
          "brier": 0.12821762556346064
        },
        "test_temp_scaled": {
          "enabled": true,
          "T": 0.5327835083007812,
          "ece": 0.058004408419132264,
          "nll": 0.28435689210891724,
          "brier": 0.13913673049836775
        },
        "inference_benchmark": {
          "latency_batch1": {
            "batch": 1,
            "mean_batch_ms": 11.523702000073778,
            "std_batch_ms": 0.6214025101397678,
            "ms_per_img": 11.523702000073778,
            "imgs_per_s": 86.77766918943216,
            "peak_vram_gb": 0.10259437561035156
          },
          "throughput_batchN": {
            "batch": 64,
            "mean_batch_ms": 24.959620001124375,
            "std_batch_ms": 0.3785854093833206,
            "ms_per_img": 0.38999406251756835,
            "imgs_per_s": 2564.141601399258,
            "peak_vram_gb": 0.2894110679626465
          }
        },
        "inference_quick": {
          "b1_ms_per_img": 11.523702000073778,
          "b1_imgs_per_s": 86.77766918943216,
          "b64_ms_per_img": 0.38999406251756835,
          "b64_imgs_per_s": 2564.141601399258
        }
      },
      "raw": {
        "dataset": "OCT2017",
        "root": "D:\\AIUB\\DSP\\Code\\Datasets\\ZhangLabData\\OCT2017_CLEAN_SHAONLY",
        "classes": [
          "CNV",
          "DME",
          "DRUSEN",
          "NORMAL"
        ],
        "model": "deit_small_distilled_patch16_224",
        "peft": "Manual LoRA into qkv (frozen backbone)",
        "lora": {
          "r": 8,
          "alpha": 16,
          "dropout": 0.1,
          "merged_for_timing": true
        },
        "params": {
          "total": 21816968,
          "trainable": 150536,
          "trainable_pct": 0.6899950533914704
        },
        "storage": {
          "best_model_path": "runs\\OCT2017\\deit_small_lora_frozen_4c\\20251225-081806\\best_model.pth",
          "adapter_only_enabled": true,
          "adapter_only_bytes": 611321,
          "adapter_only_mb": 0.5830011367797852
        },
        "training": {
          "epochs_ran": 100,
          "best_val_loss": 0.4697935613580405,
          "best_val_macro_f1": 0.9708529679182543,
          "total_train_time_sec": 13304.88613653183,
          "mean_epoch_time_sec": 127.12739509820938,
          "peak_train_vram_gb": 1.7478580474853516
        },
        "test_uncalibrated": {
          "acc": 0.92,
          "macro_f1": 0.9185539959606476,
          "macro_auc": 0.9926173333333335,
          "ece": 0.08643192729353905,
          "nll": 0.2727710008621216,
          "brier": 0.12821762556346064
        },
        "test_temp_scaled": {
          "enabled": true,
          "T": 0.5327835083007812,
          "ece": 0.058004408419132264,
          "nll": 0.28435689210891724,
          "brier": 0.13913673049836775
        },
        "inference_benchmark": {
          "latency_batch1": {
            "batch": 1,
            "mean_batch_ms": 11.523702000073778,
            "std_batch_ms": 0.6214025101397678,
            "ms_per_img": 11.523702000073778,
            "imgs_per_s": 86.77766918943216,
            "peak_vram_gb": 0.10259437561035156
          },
          "throughput_batchN": {
            "batch": 64,
            "mean_batch_ms": 24.959620001124375,
            "std_batch_ms": 0.3785854093833206,
            "ms_per_img": 0.38999406251756835,
            "imgs_per_s": 2564.141601399258,
            "peak_vram_gb": 0.2894110679626465
          }
        }
      }
    },
    {
      "source": {
        "relative_path": "runs/C8/deit_small_lora_frozen_8c/20251224-153624/summary.json",
        "absolute_path": "D:\\AIUB\\DSP\\Code\\Models\\ViT + LoRA (frozen)\\runs\\C8\\deit_small_lora_frozen_8c\\20251224-153624\\summary.json"
      },
      "facts": {
        "dataset": "C8",
        "root": "D:\\AIUB\\DSP\\Code\\Datasets\\C8\\RetinalOCT_Dataset_CLEAN_SHAONLY",
        "model": "deit_small_distilled_patch16_224",
        "peft": "Manual LoRA into qkv (frozen backbone)",
        "classes": [
          "AMD",
          "CNV",
          "CSR",
          "DME",
          "DR",
          "DRUSEN",
          "MH",
          "NORMAL"
        ],
        "num_classes": 8,
        "lora": {
          "r": 8,
          "alpha": 16,
          "dropout": 0.1,
          "merged_for_timing": true
        },
        "params": {
          "total": 21820048,
          "trainable": 153616,
          "trainable_pct": 0.7040131167447478
        },
        "storage": {
          "best_model_path": "runs\\C8\\deit_small_lora_frozen_8c\\20251224-153624\\best_model.pth",
          "adapter_only_enabled": true,
          "adapter_only_mb": 0.5947198867797852,
          "adapter_only_bytes": 623609
        },
        "training": {
          "epochs_ran": 42,
          "best_val_loss": 0.5422499910973324,
          "best_val_macro_f1": 0.9698877212320325,
          "total_train_time_sec": 1165.4118185043335,
          "mean_epoch_time_sec": 26.03511893749237,
          "peak_train_vram_gb": 1.7488632202148438
        },
        "test_uncalibrated": {
          "acc": 0.9692527708258849,
          "macro_f1": 0.9692348133616528,
          "macro_auc": 0.9977358898524147,
          "ece": 0.07838518275590639,
          "nll": 0.17066547274589539,
          "brier": 0.05545268128285275
        },
        "test_temp_scaled": {
          "enabled": true,
          "T": 0.6713962554931641,
          "ece": 0.008098090615577699,
          "nll": 0.1127440482378006,
          "brier": 0.050944388133193796
        },
        "inference_benchmark": {
          "latency_batch1": {
            "batch": 1,
            "mean_batch_ms": 13.065877333113653,
            "std_batch_ms": 1.2803949977461186,
            "ms_per_img": 13.065877333113653,
            "imgs_per_s": 76.53523559919232,
            "peak_vram_gb": 0.10213804244995117
          },
          "throughput_batchN": {
            "batch": 64,
            "mean_batch_ms": 25.00499533324425,
            "std_batch_ms": 0.3415060670092186,
            "ms_per_img": 0.3907030520819414,
            "imgs_per_s": 2559.488580064309,
            "peak_vram_gb": 0.2893819808959961
          }
        },
        "inference_quick": {
          "b1_ms_per_img": 13.065877333113653,
          "b1_imgs_per_s": 76.53523559919232,
          "b64_ms_per_img": 0.3907030520819414,
          "b64_imgs_per_s": 2559.488580064309
        }
      },
      "raw": {
        "dataset": "C8",
        "root": "D:\\AIUB\\DSP\\Code\\Datasets\\C8\\RetinalOCT_Dataset_CLEAN_SHAONLY",
        "classes": [
          "AMD",
          "CNV",
          "CSR",
          "DME",
          "DR",
          "DRUSEN",
          "MH",
          "NORMAL"
        ],
        "model": "deit_small_distilled_patch16_224",
        "peft": "Manual LoRA into qkv (frozen backbone)",
        "lora": {
          "r": 8,
          "alpha": 16,
          "dropout": 0.1,
          "merged_for_timing": true
        },
        "params": {
          "total": 21820048,
          "trainable": 153616,
          "trainable_pct": 0.7040131167447478
        },
        "storage": {
          "best_model_path": "runs\\C8\\deit_small_lora_frozen_8c\\20251224-153624\\best_model.pth",
          "adapter_only_enabled": true,
          "adapter_only_bytes": 623609,
          "adapter_only_mb": 0.5947198867797852
        },
        "training": {
          "epochs_ran": 42,
          "best_val_loss": 0.5422499910973324,
          "best_val_macro_f1": 0.9698877212320325,
          "total_train_time_sec": 1165.4118185043335,
          "mean_epoch_time_sec": 26.03511893749237,
          "peak_train_vram_gb": 1.7488632202148438
        },
        "test_uncalibrated": {
          "acc": 0.9692527708258849,
          "macro_f1": 0.9692348133616528,
          "macro_auc": 0.9977358898524147,
          "ece": 0.07838518275590639,
          "nll": 0.17066547274589539,
          "brier": 0.05545268128285275
        },
        "test_temp_scaled": {
          "enabled": true,
          "T": 0.6713962554931641,
          "ece": 0.008098090615577699,
          "nll": 0.1127440482378006,
          "brier": 0.050944388133193796
        },
        "inference_benchmark": {
          "latency_batch1": {
            "batch": 1,
            "mean_batch_ms": 13.065877333113653,
            "std_batch_ms": 1.2803949977461186,
            "ms_per_img": 13.065877333113653,
            "imgs_per_s": 76.53523559919232,
            "peak_vram_gb": 0.10213804244995117
          },
          "throughput_batchN": {
            "batch": 64,
            "mean_batch_ms": 25.00499533324425,
            "std_batch_ms": 0.3415060670092186,
            "ms_per_img": 0.3907030520819414,
            "imgs_per_s": 2559.488580064309,
            "peak_vram_gb": 0.2893819808959961
          }
        }
      }
    },
    {
      "source": {
        "relative_path": "runs/NEH_UT_2021/deit_small_lora_frozen_3c/20251224-152406/summary.json",
        "absolute_path": "D:\\AIUB\\DSP\\Code\\Models\\ViT + LoRA (frozen)\\runs\\NEH_UT_2021\\deit_small_lora_frozen_3c\\20251224-152406\\summary.json"
      },
      "facts": {
        "dataset": "NEH_UT_2021",
        "root": "D:\\AIUB\\DSP\\Code\\Datasets\\NEH_UT_2021RetinalOCTDataset\\NEH_UT_2021RetinalOCTDataset_V2_CLEAN_SHAONLY",
        "model": "deit_small_distilled_patch16_224",
        "peft": "Manual LoRA into qkv (frozen backbone)",
        "classes": [
          "CNV",
          "DRUSEN",
          "NORMAL"
        ],
        "num_classes": 3,
        "lora": {
          "r": 8,
          "alpha": 16,
          "dropout": 0.1,
          "merged_for_timing": true
        },
        "params": {
          "total": 21816198,
          "trainable": 149766,
          "trainable_pct": 0.6864899190958937
        },
        "storage": {
          "best_model_path": "runs\\NEH_UT_2021\\deit_small_lora_frozen_3c\\20251224-152406\\best_model.pth",
          "adapter_only_enabled": true,
          "adapter_only_mb": 0.5800714492797852,
          "adapter_only_bytes": 608249
        },
        "training": {
          "epochs_ran": 22,
          "best_val_loss": 0.5826475243557567,
          "best_val_macro_f1": 0.878483127341198,
          "total_train_time_sec": 395.15614581108093,
          "mean_epoch_time_sec": 16.328915780240838,
          "peak_train_vram_gb": 1.7484803199768066
        },
        "test_uncalibrated": {
          "acc": 0.8771304003170829,
          "macro_f1": 0.8619417225225732,
          "macro_auc": 0.9564786996804191,
          "ece": 0.07150406064705579,
          "nll": 0.37574586272239685,
          "brier": 0.19546066995533004
        },
        "test_temp_scaled": {
          "enabled": true,
          "T": 0.6801462173461914,
          "ece": 0.015057973584342568,
          "nll": 0.34299054741859436,
          "brier": 0.18662561682306394
        },
        "inference_benchmark": {
          "latency_batch1": {
            "batch": 1,
            "mean_batch_ms": 13.6389680000381,
            "std_batch_ms": 1.433001584369978,
            "ms_per_img": 13.6389680000381,
            "imgs_per_s": 73.3193303186287,
            "peak_vram_gb": 0.10200691223144531
          },
          "throughput_batchN": {
            "batch": 64,
            "mean_batch_ms": 25.295106666708307,
            "std_batch_ms": 0.5782085397849618,
            "ms_per_img": 0.3952360416673173,
            "imgs_per_s": 2530.133627949173,
            "peak_vram_gb": 0.28925085067749023
          }
        },
        "inference_quick": {
          "b1_ms_per_img": 13.6389680000381,
          "b1_imgs_per_s": 73.3193303186287,
          "b64_ms_per_img": 0.3952360416673173,
          "b64_imgs_per_s": 2530.133627949173
        }
      },
      "raw": {
        "dataset": "NEH_UT_2021",
        "root": "D:\\AIUB\\DSP\\Code\\Datasets\\NEH_UT_2021RetinalOCTDataset\\NEH_UT_2021RetinalOCTDataset_V2_CLEAN_SHAONLY",
        "classes": [
          "CNV",
          "DRUSEN",
          "NORMAL"
        ],
        "model": "deit_small_distilled_patch16_224",
        "peft": "Manual LoRA into qkv (frozen backbone)",
        "lora": {
          "r": 8,
          "alpha": 16,
          "dropout": 0.1,
          "merged_for_timing": true
        },
        "params": {
          "total": 21816198,
          "trainable": 149766,
          "trainable_pct": 0.6864899190958937
        },
        "storage": {
          "best_model_path": "runs\\NEH_UT_2021\\deit_small_lora_frozen_3c\\20251224-152406\\best_model.pth",
          "adapter_only_enabled": true,
          "adapter_only_bytes": 608249,
          "adapter_only_mb": 0.5800714492797852
        },
        "training": {
          "epochs_ran": 22,
          "best_val_loss": 0.5826475243557567,
          "best_val_macro_f1": 0.878483127341198,
          "total_train_time_sec": 395.15614581108093,
          "mean_epoch_time_sec": 16.328915780240838,
          "peak_train_vram_gb": 1.7484803199768066
        },
        "test_uncalibrated": {
          "acc": 0.8771304003170829,
          "macro_f1": 0.8619417225225732,
          "macro_auc": 0.9564786996804191,
          "ece": 0.07150406064705579,
          "nll": 0.37574586272239685,
          "brier": 0.19546066995533004
        },
        "test_temp_scaled": {
          "enabled": true,
          "T": 0.6801462173461914,
          "ece": 0.015057973584342568,
          "nll": 0.34299054741859436,
          "brier": 0.18662561682306394
        },
        "inference_benchmark": {
          "latency_batch1": {
            "batch": 1,
            "mean_batch_ms": 13.6389680000381,
            "std_batch_ms": 1.433001584369978,
            "ms_per_img": 13.6389680000381,
            "imgs_per_s": 73.3193303186287,
            "peak_vram_gb": 0.10200691223144531
          },
          "throughput_batchN": {
            "batch": 64,
            "mean_batch_ms": 25.295106666708307,
            "std_batch_ms": 0.5782085397849618,
            "ms_per_img": 0.3952360416673173,
            "imgs_per_s": 2530.133627949173,
            "peak_vram_gb": 0.28925085067749023
          }
        }
      }
    },
    {
      "source": {
        "relative_path": "runs/Srinivasan_2014/deit_small_lora_frozen_3c/20251224-151655/summary.json",
        "absolute_path": "D:\\AIUB\\DSP\\Code\\Models\\ViT + LoRA (frozen)\\runs\\Srinivasan_2014\\deit_small_lora_frozen_3c\\20251224-151655\\summary.json"
      },
      "facts": {
        "dataset": "Srinivasan_2014",
        "root": "D:\\AIUB\\DSP\\Code\\Datasets\\Srinivasan_2014\\Srinivasan_2014_CLEAN_SHAONLY",
        "model": "deit_small_distilled_patch16_224",
        "peft": "Manual LoRA into qkv (frozen backbone)",
        "classes": [
          "AMD",
          "DME",
          "NORMAL"
        ],
        "num_classes": 3,
        "lora": {
          "r": 8,
          "alpha": 16,
          "dropout": 0.1,
          "merged_for_timing": true
        },
        "params": {
          "total": 21816198,
          "trainable": 149766,
          "trainable_pct": 0.6864899190958937
        },
        "storage": {
          "best_model_path": "runs\\Srinivasan_2014\\deit_small_lora_frozen_3c\\20251224-151655\\best_model.pth",
          "adapter_only_enabled": true,
          "adapter_only_mb": 0.5800714492797852,
          "adapter_only_bytes": 608249
        },
        "training": {
          "epochs_ran": 46,
          "best_val_loss": 0.3303019550043283,
          "best_val_macro_f1": 1.0,
          "total_train_time_sec": 164.6878571510315,
          "mean_epoch_time_sec": 3.2353533506393433,
          "peak_train_vram_gb": 1.746690273284912
        },
        "test_uncalibrated": {
          "acc": 0.9979381443298969,
          "macro_f1": 0.9976758796250903,
          "macro_auc": 1.0,
          "ece": 0.07776476107921798,
          "nll": 0.08880162239074707,
          "brier": 0.014248776783634164
        },
        "test_temp_scaled": {
          "enabled": true,
          "T": 0.27837154269218445,
          "ece": 0.002283274512930063,
          "nll": 0.018748478963971138,
          "brier": 0.004190062107729791
        },
        "inference_benchmark": {
          "latency_batch1": {
            "batch": 1,
            "mean_batch_ms": 12.245247333424535,
            "std_batch_ms": 2.5796743095723627,
            "ms_per_img": 12.245247333424535,
            "imgs_per_s": 81.66433660105889,
            "peak_vram_gb": 0.10141801834106445
          },
          "throughput_batchN": {
            "batch": 64,
            "mean_batch_ms": 25.28860999996444,
            "std_batch_ms": 0.3694822090504663,
            "ms_per_img": 0.39513453124944437,
            "imgs_per_s": 2530.78362156283,
            "peak_vram_gb": 0.2886619567871094
          }
        },
        "inference_quick": {
          "b1_ms_per_img": 12.245247333424535,
          "b1_imgs_per_s": 81.66433660105889,
          "b64_ms_per_img": 0.39513453124944437,
          "b64_imgs_per_s": 2530.78362156283
        }
      },
      "raw": {
        "dataset": "Srinivasan_2014",
        "root": "D:\\AIUB\\DSP\\Code\\Datasets\\Srinivasan_2014\\Srinivasan_2014_CLEAN_SHAONLY",
        "classes": [
          "AMD",
          "DME",
          "NORMAL"
        ],
        "model": "deit_small_distilled_patch16_224",
        "peft": "Manual LoRA into qkv (frozen backbone)",
        "lora": {
          "r": 8,
          "alpha": 16,
          "dropout": 0.1,
          "merged_for_timing": true
        },
        "params": {
          "total": 21816198,
          "trainable": 149766,
          "trainable_pct": 0.6864899190958937
        },
        "storage": {
          "best_model_path": "runs\\Srinivasan_2014\\deit_small_lora_frozen_3c\\20251224-151655\\best_model.pth",
          "adapter_only_enabled": true,
          "adapter_only_bytes": 608249,
          "adapter_only_mb": 0.5800714492797852
        },
        "training": {
          "epochs_ran": 46,
          "best_val_loss": 0.3303019550043283,
          "best_val_macro_f1": 1.0,
          "total_train_time_sec": 164.6878571510315,
          "mean_epoch_time_sec": 3.2353533506393433,
          "peak_train_vram_gb": 1.746690273284912
        },
        "test_uncalibrated": {
          "acc": 0.9979381443298969,
          "macro_f1": 0.9976758796250903,
          "macro_auc": 1.0,
          "ece": 0.07776476107921798,
          "nll": 0.08880162239074707,
          "brier": 0.014248776783634164
        },
        "test_temp_scaled": {
          "enabled": true,
          "T": 0.27837154269218445,
          "ece": 0.002283274512930063,
          "nll": 0.018748478963971138,
          "brier": 0.004190062107729791
        },
        "inference_benchmark": {
          "latency_batch1": {
            "batch": 1,
            "mean_batch_ms": 12.245247333424535,
            "std_batch_ms": 2.5796743095723627,
            "ms_per_img": 12.245247333424535,
            "imgs_per_s": 81.66433660105889,
            "peak_vram_gb": 0.10141801834106445
          },
          "throughput_batchN": {
            "batch": 64,
            "mean_batch_ms": 25.28860999996444,
            "std_batch_ms": 0.3694822090504663,
            "ms_per_img": 0.39513453124944437,
            "imgs_per_s": 2530.78362156283,
            "peak_vram_gb": 0.2886619567871094
          }
        }
      }
    },
    {
      "source": {
        "relative_path": "runs/THOCT/deit_small_lora_frozen_3c/20251224-151457/summary.json",
        "absolute_path": "D:\\AIUB\\DSP\\Code\\Models\\ViT + LoRA (frozen)\\runs\\THOCT\\deit_small_lora_frozen_3c\\20251224-151457\\summary.json"
      },
      "facts": {
        "dataset": "THOCT",
        "root": "D:\\AIUB\\DSP\\Code\\Datasets\\THOCT1800\\THOCT1800_CLEAN_SHAONLY",
        "model": "deit_small_distilled_patch16_224",
        "peft": "Manual LoRA into qkv (frozen backbone)",
        "classes": [
          "AMD",
          "DME",
          "NOR"
        ],
        "num_classes": 3,
        "lora": {
          "r": 8,
          "alpha": 16,
          "dropout": 0.1,
          "merged_for_timing": true
        },
        "params": {
          "total": 21816198,
          "trainable": 149766,
          "trainable_pct": 0.6864899190958937
        },
        "storage": {
          "best_model_path": "runs\\THOCT\\deit_small_lora_frozen_3c\\20251224-151457\\best_model.pth",
          "adapter_only_enabled": true,
          "adapter_only_mb": 0.5800714492797852,
          "adapter_only_bytes": 608249
        },
        "training": {
          "epochs_ran": 47,
          "best_val_loss": 0.29212614802213815,
          "best_val_macro_f1": 1.0,
          "total_train_time_sec": 91.92279839515686,
          "mean_epoch_time_sec": 1.7349390171943826,
          "peak_train_vram_gb": 1.748227596282959
        },
        "test_uncalibrated": {
          "acc": 0.9961538461538462,
          "macro_f1": 0.996144374240854,
          "macro_auc": 0.9999327731092437,
          "ece": 0.06486714207209071,
          "nll": 0.08280275762081146,
          "brier": 0.01385067434951556
        },
        "test_temp_scaled": {
          "enabled": true,
          "T": 0.3051670789718628,
          "ece": 0.003800139060387231,
          "nll": 0.037936434149742126,
          "brier": 0.007690866678941479
        },
        "inference_benchmark": {
          "latency_batch1": {
            "batch": 1,
            "mean_batch_ms": 11.910581999945862,
            "std_batch_ms": 0.9670862307587677,
            "ms_per_img": 11.910581999945862,
            "imgs_per_s": 83.95895347553507,
            "peak_vram_gb": 0.10202169418334961
          },
          "throughput_batchN": {
            "batch": 64,
            "mean_batch_ms": 25.083821333391825,
            "std_batch_ms": 0.4055006272669166,
            "ms_per_img": 0.39193470833424726,
            "imgs_per_s": 2551.4453778540746,
            "peak_vram_gb": 0.28883838653564453
          }
        },
        "inference_quick": {
          "b1_ms_per_img": 11.910581999945862,
          "b1_imgs_per_s": 83.95895347553507,
          "b64_ms_per_img": 0.39193470833424726,
          "b64_imgs_per_s": 2551.4453778540746
        }
      },
      "raw": {
        "dataset": "THOCT",
        "root": "D:\\AIUB\\DSP\\Code\\Datasets\\THOCT1800\\THOCT1800_CLEAN_SHAONLY",
        "classes": [
          "AMD",
          "DME",
          "NOR"
        ],
        "model": "deit_small_distilled_patch16_224",
        "peft": "Manual LoRA into qkv (frozen backbone)",
        "lora": {
          "r": 8,
          "alpha": 16,
          "dropout": 0.1,
          "merged_for_timing": true
        },
        "params": {
          "total": 21816198,
          "trainable": 149766,
          "trainable_pct": 0.6864899190958937
        },
        "storage": {
          "best_model_path": "runs\\THOCT\\deit_small_lora_frozen_3c\\20251224-151457\\best_model.pth",
          "adapter_only_enabled": true,
          "adapter_only_bytes": 608249,
          "adapter_only_mb": 0.5800714492797852
        },
        "training": {
          "epochs_ran": 47,
          "best_val_loss": 0.29212614802213815,
          "best_val_macro_f1": 1.0,
          "total_train_time_sec": 91.92279839515686,
          "mean_epoch_time_sec": 1.7349390171943826,
          "peak_train_vram_gb": 1.748227596282959
        },
        "test_uncalibrated": {
          "acc": 0.9961538461538462,
          "macro_f1": 0.996144374240854,
          "macro_auc": 0.9999327731092437,
          "ece": 0.06486714207209071,
          "nll": 0.08280275762081146,
          "brier": 0.01385067434951556
        },
        "test_temp_scaled": {
          "enabled": true,
          "T": 0.3051670789718628,
          "ece": 0.003800139060387231,
          "nll": 0.037936434149742126,
          "brier": 0.007690866678941479
        },
        "inference_benchmark": {
          "latency_batch1": {
            "batch": 1,
            "mean_batch_ms": 11.910581999945862,
            "std_batch_ms": 0.9670862307587677,
            "ms_per_img": 11.910581999945862,
            "imgs_per_s": 83.95895347553507,
            "peak_vram_gb": 0.10202169418334961
          },
          "throughput_batchN": {
            "batch": 64,
            "mean_batch_ms": 25.083821333391825,
            "std_batch_ms": 0.4055006272669166,
            "ms_per_img": 0.39193470833424726,
            "imgs_per_s": 2551.4453778540746,
            "peak_vram_gb": 0.28883838653564453
          }
        }
      }
    }
  ],
  "by_dataset": {
    "OCT2017": [
      {
        "source": {
          "relative_path": "OCT2017/runs/OCT2017/deit_small_lora_frozen_4c/20251225-081806/summary.json",
          "absolute_path": "D:\\AIUB\\DSP\\Code\\Models\\ViT + LoRA (frozen)\\OCT2017\\runs\\OCT2017\\deit_small_lora_frozen_4c\\20251225-081806\\summary.json"
        },
        "facts": {
          "dataset": "OCT2017",
          "root": "D:\\AIUB\\DSP\\Code\\Datasets\\ZhangLabData\\OCT2017_CLEAN_SHAONLY",
          "model": "deit_small_distilled_patch16_224",
          "peft": "Manual LoRA into qkv (frozen backbone)",
          "classes": [
            "CNV",
            "DME",
            "DRUSEN",
            "NORMAL"
          ],
          "num_classes": 4,
          "lora": {
            "r": 8,
            "alpha": 16,
            "dropout": 0.1,
            "merged_for_timing": true
          },
          "params": {
            "total": 21816968,
            "trainable": 150536,
            "trainable_pct": 0.6899950533914704
          },
          "storage": {
            "best_model_path": "runs\\OCT2017\\deit_small_lora_frozen_4c\\20251225-081806\\best_model.pth",
            "adapter_only_enabled": true,
            "adapter_only_mb": 0.5830011367797852,
            "adapter_only_bytes": 611321
          },
          "training": {
            "epochs_ran": 100,
            "best_val_loss": 0.4697935613580405,
            "best_val_macro_f1": 0.9708529679182543,
            "total_train_time_sec": 13304.88613653183,
            "mean_epoch_time_sec": 127.12739509820938,
            "peak_train_vram_gb": 1.7478580474853516
          },
          "test_uncalibrated": {
            "acc": 0.92,
            "macro_f1": 0.9185539959606476,
            "macro_auc": 0.9926173333333335,
            "ece": 0.08643192729353905,
            "nll": 0.2727710008621216,
            "brier": 0.12821762556346064
          },
          "test_temp_scaled": {
            "enabled": true,
            "T": 0.5327835083007812,
            "ece": 0.058004408419132264,
            "nll": 0.28435689210891724,
            "brier": 0.13913673049836775
          },
          "inference_benchmark": {
            "latency_batch1": {
              "batch": 1,
              "mean_batch_ms": 11.523702000073778,
              "std_batch_ms": 0.6214025101397678,
              "ms_per_img": 11.523702000073778,
              "imgs_per_s": 86.77766918943216,
              "peak_vram_gb": 0.10259437561035156
            },
            "throughput_batchN": {
              "batch": 64,
              "mean_batch_ms": 24.959620001124375,
              "std_batch_ms": 0.3785854093833206,
              "ms_per_img": 0.38999406251756835,
              "imgs_per_s": 2564.141601399258,
              "peak_vram_gb": 0.2894110679626465
            }
          },
          "inference_quick": {
            "b1_ms_per_img": 11.523702000073778,
            "b1_imgs_per_s": 86.77766918943216,
            "b64_ms_per_img": 0.38999406251756835,
            "b64_imgs_per_s": 2564.141601399258
          }
        },
        "raw": {
          "dataset": "OCT2017",
          "root": "D:\\AIUB\\DSP\\Code\\Datasets\\ZhangLabData\\OCT2017_CLEAN_SHAONLY",
          "classes": [
            "CNV",
            "DME",
            "DRUSEN",
            "NORMAL"
          ],
          "model": "deit_small_distilled_patch16_224",
          "peft": "Manual LoRA into qkv (frozen backbone)",
          "lora": {
            "r": 8,
            "alpha": 16,
            "dropout": 0.1,
            "merged_for_timing": true
          },
          "params": {
            "total": 21816968,
            "trainable": 150536,
            "trainable_pct": 0.6899950533914704
          },
          "storage": {
            "best_model_path": "runs\\OCT2017\\deit_small_lora_frozen_4c\\20251225-081806\\best_model.pth",
            "adapter_only_enabled": true,
            "adapter_only_bytes": 611321,
            "adapter_only_mb": 0.5830011367797852
          },
          "training": {
            "epochs_ran": 100,
            "best_val_loss": 0.4697935613580405,
            "best_val_macro_f1": 0.9708529679182543,
            "total_train_time_sec": 13304.88613653183,
            "mean_epoch_time_sec": 127.12739509820938,
            "peak_train_vram_gb": 1.7478580474853516
          },
          "test_uncalibrated": {
            "acc": 0.92,
            "macro_f1": 0.9185539959606476,
            "macro_auc": 0.9926173333333335,
            "ece": 0.08643192729353905,
            "nll": 0.2727710008621216,
            "brier": 0.12821762556346064
          },
          "test_temp_scaled": {
            "enabled": true,
            "T": 0.5327835083007812,
            "ece": 0.058004408419132264,
            "nll": 0.28435689210891724,
            "brier": 0.13913673049836775
          },
          "inference_benchmark": {
            "latency_batch1": {
              "batch": 1,
              "mean_batch_ms": 11.523702000073778,
              "std_batch_ms": 0.6214025101397678,
              "ms_per_img": 11.523702000073778,
              "imgs_per_s": 86.77766918943216,
              "peak_vram_gb": 0.10259437561035156
            },
            "throughput_batchN": {
              "batch": 64,
              "mean_batch_ms": 24.959620001124375,
              "std_batch_ms": 0.3785854093833206,
              "ms_per_img": 0.38999406251756835,
              "imgs_per_s": 2564.141601399258,
              "peak_vram_gb": 0.2894110679626465
            }
          }
        }
      }
    ],
    "C8": [
      {
        "source": {
          "relative_path": "runs/C8/deit_small_lora_frozen_8c/20251224-153624/summary.json",
          "absolute_path": "D:\\AIUB\\DSP\\Code\\Models\\ViT + LoRA (frozen)\\runs\\C8\\deit_small_lora_frozen_8c\\20251224-153624\\summary.json"
        },
        "facts": {
          "dataset": "C8",
          "root": "D:\\AIUB\\DSP\\Code\\Datasets\\C8\\RetinalOCT_Dataset_CLEAN_SHAONLY",
          "model": "deit_small_distilled_patch16_224",
          "peft": "Manual LoRA into qkv (frozen backbone)",
          "classes": [
            "AMD",
            "CNV",
            "CSR",
            "DME",
            "DR",
            "DRUSEN",
            "MH",
            "NORMAL"
          ],
          "num_classes": 8,
          "lora": {
            "r": 8,
            "alpha": 16,
            "dropout": 0.1,
            "merged_for_timing": true
          },
          "params": {
            "total": 21820048,
            "trainable": 153616,
            "trainable_pct": 0.7040131167447478
          },
          "storage": {
            "best_model_path": "runs\\C8\\deit_small_lora_frozen_8c\\20251224-153624\\best_model.pth",
            "adapter_only_enabled": true,
            "adapter_only_mb": 0.5947198867797852,
            "adapter_only_bytes": 623609
          },
          "training": {
            "epochs_ran": 42,
            "best_val_loss": 0.5422499910973324,
            "best_val_macro_f1": 0.9698877212320325,
            "total_train_time_sec": 1165.4118185043335,
            "mean_epoch_time_sec": 26.03511893749237,
            "peak_train_vram_gb": 1.7488632202148438
          },
          "test_uncalibrated": {
            "acc": 0.9692527708258849,
            "macro_f1": 0.9692348133616528,
            "macro_auc": 0.9977358898524147,
            "ece": 0.07838518275590639,
            "nll": 0.17066547274589539,
            "brier": 0.05545268128285275
          },
          "test_temp_scaled": {
            "enabled": true,
            "T": 0.6713962554931641,
            "ece": 0.008098090615577699,
            "nll": 0.1127440482378006,
            "brier": 0.050944388133193796
          },
          "inference_benchmark": {
            "latency_batch1": {
              "batch": 1,
              "mean_batch_ms": 13.065877333113653,
              "std_batch_ms": 1.2803949977461186,
              "ms_per_img": 13.065877333113653,
              "imgs_per_s": 76.53523559919232,
              "peak_vram_gb": 0.10213804244995117
            },
            "throughput_batchN": {
              "batch": 64,
              "mean_batch_ms": 25.00499533324425,
              "std_batch_ms": 0.3415060670092186,
              "ms_per_img": 0.3907030520819414,
              "imgs_per_s": 2559.488580064309,
              "peak_vram_gb": 0.2893819808959961
            }
          },
          "inference_quick": {
            "b1_ms_per_img": 13.065877333113653,
            "b1_imgs_per_s": 76.53523559919232,
            "b64_ms_per_img": 0.3907030520819414,
            "b64_imgs_per_s": 2559.488580064309
          }
        },
        "raw": {
          "dataset": "C8",
          "root": "D:\\AIUB\\DSP\\Code\\Datasets\\C8\\RetinalOCT_Dataset_CLEAN_SHAONLY",
          "classes": [
            "AMD",
            "CNV",
            "CSR",
            "DME",
            "DR",
            "DRUSEN",
            "MH",
            "NORMAL"
          ],
          "model": "deit_small_distilled_patch16_224",
          "peft": "Manual LoRA into qkv (frozen backbone)",
          "lora": {
            "r": 8,
            "alpha": 16,
            "dropout": 0.1,
            "merged_for_timing": true
          },
          "params": {
            "total": 21820048,
            "trainable": 153616,
            "trainable_pct": 0.7040131167447478
          },
          "storage": {
            "best_model_path": "runs\\C8\\deit_small_lora_frozen_8c\\20251224-153624\\best_model.pth",
            "adapter_only_enabled": true,
            "adapter_only_bytes": 623609,
            "adapter_only_mb": 0.5947198867797852
          },
          "training": {
            "epochs_ran": 42,
            "best_val_loss": 0.5422499910973324,
            "best_val_macro_f1": 0.9698877212320325,
            "total_train_time_sec": 1165.4118185043335,
            "mean_epoch_time_sec": 26.03511893749237,
            "peak_train_vram_gb": 1.7488632202148438
          },
          "test_uncalibrated": {
            "acc": 0.9692527708258849,
            "macro_f1": 0.9692348133616528,
            "macro_auc": 0.9977358898524147,
            "ece": 0.07838518275590639,
            "nll": 0.17066547274589539,
            "brier": 0.05545268128285275
          },
          "test_temp_scaled": {
            "enabled": true,
            "T": 0.6713962554931641,
            "ece": 0.008098090615577699,
            "nll": 0.1127440482378006,
            "brier": 0.050944388133193796
          },
          "inference_benchmark": {
            "latency_batch1": {
              "batch": 1,
              "mean_batch_ms": 13.065877333113653,
              "std_batch_ms": 1.2803949977461186,
              "ms_per_img": 13.065877333113653,
              "imgs_per_s": 76.53523559919232,
              "peak_vram_gb": 0.10213804244995117
            },
            "throughput_batchN": {
              "batch": 64,
              "mean_batch_ms": 25.00499533324425,
              "std_batch_ms": 0.3415060670092186,
              "ms_per_img": 0.3907030520819414,
              "imgs_per_s": 2559.488580064309,
              "peak_vram_gb": 0.2893819808959961
            }
          }
        }
      }
    ],
    "NEH_UT_2021": [
      {
        "source": {
          "relative_path": "runs/NEH_UT_2021/deit_small_lora_frozen_3c/20251224-152406/summary.json",
          "absolute_path": "D:\\AIUB\\DSP\\Code\\Models\\ViT + LoRA (frozen)\\runs\\NEH_UT_2021\\deit_small_lora_frozen_3c\\20251224-152406\\summary.json"
        },
        "facts": {
          "dataset": "NEH_UT_2021",
          "root": "D:\\AIUB\\DSP\\Code\\Datasets\\NEH_UT_2021RetinalOCTDataset\\NEH_UT_2021RetinalOCTDataset_V2_CLEAN_SHAONLY",
          "model": "deit_small_distilled_patch16_224",
          "peft": "Manual LoRA into qkv (frozen backbone)",
          "classes": [
            "CNV",
            "DRUSEN",
            "NORMAL"
          ],
          "num_classes": 3,
          "lora": {
            "r": 8,
            "alpha": 16,
            "dropout": 0.1,
            "merged_for_timing": true
          },
          "params": {
            "total": 21816198,
            "trainable": 149766,
            "trainable_pct": 0.6864899190958937
          },
          "storage": {
            "best_model_path": "runs\\NEH_UT_2021\\deit_small_lora_frozen_3c\\20251224-152406\\best_model.pth",
            "adapter_only_enabled": true,
            "adapter_only_mb": 0.5800714492797852,
            "adapter_only_bytes": 608249
          },
          "training": {
            "epochs_ran": 22,
            "best_val_loss": 0.5826475243557567,
            "best_val_macro_f1": 0.878483127341198,
            "total_train_time_sec": 395.15614581108093,
            "mean_epoch_time_sec": 16.328915780240838,
            "peak_train_vram_gb": 1.7484803199768066
          },
          "test_uncalibrated": {
            "acc": 0.8771304003170829,
            "macro_f1": 0.8619417225225732,
            "macro_auc": 0.9564786996804191,
            "ece": 0.07150406064705579,
            "nll": 0.37574586272239685,
            "brier": 0.19546066995533004
          },
          "test_temp_scaled": {
            "enabled": true,
            "T": 0.6801462173461914,
            "ece": 0.015057973584342568,
            "nll": 0.34299054741859436,
            "brier": 0.18662561682306394
          },
          "inference_benchmark": {
            "latency_batch1": {
              "batch": 1,
              "mean_batch_ms": 13.6389680000381,
              "std_batch_ms": 1.433001584369978,
              "ms_per_img": 13.6389680000381,
              "imgs_per_s": 73.3193303186287,
              "peak_vram_gb": 0.10200691223144531
            },
            "throughput_batchN": {
              "batch": 64,
              "mean_batch_ms": 25.295106666708307,
              "std_batch_ms": 0.5782085397849618,
              "ms_per_img": 0.3952360416673173,
              "imgs_per_s": 2530.133627949173,
              "peak_vram_gb": 0.28925085067749023
            }
          },
          "inference_quick": {
            "b1_ms_per_img": 13.6389680000381,
            "b1_imgs_per_s": 73.3193303186287,
            "b64_ms_per_img": 0.3952360416673173,
            "b64_imgs_per_s": 2530.133627949173
          }
        },
        "raw": {
          "dataset": "NEH_UT_2021",
          "root": "D:\\AIUB\\DSP\\Code\\Datasets\\NEH_UT_2021RetinalOCTDataset\\NEH_UT_2021RetinalOCTDataset_V2_CLEAN_SHAONLY",
          "classes": [
            "CNV",
            "DRUSEN",
            "NORMAL"
          ],
          "model": "deit_small_distilled_patch16_224",
          "peft": "Manual LoRA into qkv (frozen backbone)",
          "lora": {
            "r": 8,
            "alpha": 16,
            "dropout": 0.1,
            "merged_for_timing": true
          },
          "params": {
            "total": 21816198,
            "trainable": 149766,
            "trainable_pct": 0.6864899190958937
          },
          "storage": {
            "best_model_path": "runs\\NEH_UT_2021\\deit_small_lora_frozen_3c\\20251224-152406\\best_model.pth",
            "adapter_only_enabled": true,
            "adapter_only_bytes": 608249,
            "adapter_only_mb": 0.5800714492797852
          },
          "training": {
            "epochs_ran": 22,
            "best_val_loss": 0.5826475243557567,
            "best_val_macro_f1": 0.878483127341198,
            "total_train_time_sec": 395.15614581108093,
            "mean_epoch_time_sec": 16.328915780240838,
            "peak_train_vram_gb": 1.7484803199768066
          },
          "test_uncalibrated": {
            "acc": 0.8771304003170829,
            "macro_f1": 0.8619417225225732,
            "macro_auc": 0.9564786996804191,
            "ece": 0.07150406064705579,
            "nll": 0.37574586272239685,
            "brier": 0.19546066995533004
          },
          "test_temp_scaled": {
            "enabled": true,
            "T": 0.6801462173461914,
            "ece": 0.015057973584342568,
            "nll": 0.34299054741859436,
            "brier": 0.18662561682306394
          },
          "inference_benchmark": {
            "latency_batch1": {
              "batch": 1,
              "mean_batch_ms": 13.6389680000381,
              "std_batch_ms": 1.433001584369978,
              "ms_per_img": 13.6389680000381,
              "imgs_per_s": 73.3193303186287,
              "peak_vram_gb": 0.10200691223144531
            },
            "throughput_batchN": {
              "batch": 64,
              "mean_batch_ms": 25.295106666708307,
              "std_batch_ms": 0.5782085397849618,
              "ms_per_img": 0.3952360416673173,
              "imgs_per_s": 2530.133627949173,
              "peak_vram_gb": 0.28925085067749023
            }
          }
        }
      }
    ],
    "Srinivasan_2014": [
      {
        "source": {
          "relative_path": "runs/Srinivasan_2014/deit_small_lora_frozen_3c/20251224-151655/summary.json",
          "absolute_path": "D:\\AIUB\\DSP\\Code\\Models\\ViT + LoRA (frozen)\\runs\\Srinivasan_2014\\deit_small_lora_frozen_3c\\20251224-151655\\summary.json"
        },
        "facts": {
          "dataset": "Srinivasan_2014",
          "root": "D:\\AIUB\\DSP\\Code\\Datasets\\Srinivasan_2014\\Srinivasan_2014_CLEAN_SHAONLY",
          "model": "deit_small_distilled_patch16_224",
          "peft": "Manual LoRA into qkv (frozen backbone)",
          "classes": [
            "AMD",
            "DME",
            "NORMAL"
          ],
          "num_classes": 3,
          "lora": {
            "r": 8,
            "alpha": 16,
            "dropout": 0.1,
            "merged_for_timing": true
          },
          "params": {
            "total": 21816198,
            "trainable": 149766,
            "trainable_pct": 0.6864899190958937
          },
          "storage": {
            "best_model_path": "runs\\Srinivasan_2014\\deit_small_lora_frozen_3c\\20251224-151655\\best_model.pth",
            "adapter_only_enabled": true,
            "adapter_only_mb": 0.5800714492797852,
            "adapter_only_bytes": 608249
          },
          "training": {
            "epochs_ran": 46,
            "best_val_loss": 0.3303019550043283,
            "best_val_macro_f1": 1.0,
            "total_train_time_sec": 164.6878571510315,
            "mean_epoch_time_sec": 3.2353533506393433,
            "peak_train_vram_gb": 1.746690273284912
          },
          "test_uncalibrated": {
            "acc": 0.9979381443298969,
            "macro_f1": 0.9976758796250903,
            "macro_auc": 1.0,
            "ece": 0.07776476107921798,
            "nll": 0.08880162239074707,
            "brier": 0.014248776783634164
          },
          "test_temp_scaled": {
            "enabled": true,
            "T": 0.27837154269218445,
            "ece": 0.002283274512930063,
            "nll": 0.018748478963971138,
            "brier": 0.004190062107729791
          },
          "inference_benchmark": {
            "latency_batch1": {
              "batch": 1,
              "mean_batch_ms": 12.245247333424535,
              "std_batch_ms": 2.5796743095723627,
              "ms_per_img": 12.245247333424535,
              "imgs_per_s": 81.66433660105889,
              "peak_vram_gb": 0.10141801834106445
            },
            "throughput_batchN": {
              "batch": 64,
              "mean_batch_ms": 25.28860999996444,
              "std_batch_ms": 0.3694822090504663,
              "ms_per_img": 0.39513453124944437,
              "imgs_per_s": 2530.78362156283,
              "peak_vram_gb": 0.2886619567871094
            }
          },
          "inference_quick": {
            "b1_ms_per_img": 12.245247333424535,
            "b1_imgs_per_s": 81.66433660105889,
            "b64_ms_per_img": 0.39513453124944437,
            "b64_imgs_per_s": 2530.78362156283
          }
        },
        "raw": {
          "dataset": "Srinivasan_2014",
          "root": "D:\\AIUB\\DSP\\Code\\Datasets\\Srinivasan_2014\\Srinivasan_2014_CLEAN_SHAONLY",
          "classes": [
            "AMD",
            "DME",
            "NORMAL"
          ],
          "model": "deit_small_distilled_patch16_224",
          "peft": "Manual LoRA into qkv (frozen backbone)",
          "lora": {
            "r": 8,
            "alpha": 16,
            "dropout": 0.1,
            "merged_for_timing": true
          },
          "params": {
            "total": 21816198,
            "trainable": 149766,
            "trainable_pct": 0.6864899190958937
          },
          "storage": {
            "best_model_path": "runs\\Srinivasan_2014\\deit_small_lora_frozen_3c\\20251224-151655\\best_model.pth",
            "adapter_only_enabled": true,
            "adapter_only_bytes": 608249,
            "adapter_only_mb": 0.5800714492797852
          },
          "training": {
            "epochs_ran": 46,
            "best_val_loss": 0.3303019550043283,
            "best_val_macro_f1": 1.0,
            "total_train_time_sec": 164.6878571510315,
            "mean_epoch_time_sec": 3.2353533506393433,
            "peak_train_vram_gb": 1.746690273284912
          },
          "test_uncalibrated": {
            "acc": 0.9979381443298969,
            "macro_f1": 0.9976758796250903,
            "macro_auc": 1.0,
            "ece": 0.07776476107921798,
            "nll": 0.08880162239074707,
            "brier": 0.014248776783634164
          },
          "test_temp_scaled": {
            "enabled": true,
            "T": 0.27837154269218445,
            "ece": 0.002283274512930063,
            "nll": 0.018748478963971138,
            "brier": 0.004190062107729791
          },
          "inference_benchmark": {
            "latency_batch1": {
              "batch": 1,
              "mean_batch_ms": 12.245247333424535,
              "std_batch_ms": 2.5796743095723627,
              "ms_per_img": 12.245247333424535,
              "imgs_per_s": 81.66433660105889,
              "peak_vram_gb": 0.10141801834106445
            },
            "throughput_batchN": {
              "batch": 64,
              "mean_batch_ms": 25.28860999996444,
              "std_batch_ms": 0.3694822090504663,
              "ms_per_img": 0.39513453124944437,
              "imgs_per_s": 2530.78362156283,
              "peak_vram_gb": 0.2886619567871094
            }
          }
        }
      }
    ],
    "THOCT": [
      {
        "source": {
          "relative_path": "runs/THOCT/deit_small_lora_frozen_3c/20251224-151457/summary.json",
          "absolute_path": "D:\\AIUB\\DSP\\Code\\Models\\ViT + LoRA (frozen)\\runs\\THOCT\\deit_small_lora_frozen_3c\\20251224-151457\\summary.json"
        },
        "facts": {
          "dataset": "THOCT",
          "root": "D:\\AIUB\\DSP\\Code\\Datasets\\THOCT1800\\THOCT1800_CLEAN_SHAONLY",
          "model": "deit_small_distilled_patch16_224",
          "peft": "Manual LoRA into qkv (frozen backbone)",
          "classes": [
            "AMD",
            "DME",
            "NOR"
          ],
          "num_classes": 3,
          "lora": {
            "r": 8,
            "alpha": 16,
            "dropout": 0.1,
            "merged_for_timing": true
          },
          "params": {
            "total": 21816198,
            "trainable": 149766,
            "trainable_pct": 0.6864899190958937
          },
          "storage": {
            "best_model_path": "runs\\THOCT\\deit_small_lora_frozen_3c\\20251224-151457\\best_model.pth",
            "adapter_only_enabled": true,
            "adapter_only_mb": 0.5800714492797852,
            "adapter_only_bytes": 608249
          },
          "training": {
            "epochs_ran": 47,
            "best_val_loss": 0.29212614802213815,
            "best_val_macro_f1": 1.0,
            "total_train_time_sec": 91.92279839515686,
            "mean_epoch_time_sec": 1.7349390171943826,
            "peak_train_vram_gb": 1.748227596282959
          },
          "test_uncalibrated": {
            "acc": 0.9961538461538462,
            "macro_f1": 0.996144374240854,
            "macro_auc": 0.9999327731092437,
            "ece": 0.06486714207209071,
            "nll": 0.08280275762081146,
            "brier": 0.01385067434951556
          },
          "test_temp_scaled": {
            "enabled": true,
            "T": 0.3051670789718628,
            "ece": 0.003800139060387231,
            "nll": 0.037936434149742126,
            "brier": 0.007690866678941479
          },
          "inference_benchmark": {
            "latency_batch1": {
              "batch": 1,
              "mean_batch_ms": 11.910581999945862,
              "std_batch_ms": 0.9670862307587677,
              "ms_per_img": 11.910581999945862,
              "imgs_per_s": 83.95895347553507,
              "peak_vram_gb": 0.10202169418334961
            },
            "throughput_batchN": {
              "batch": 64,
              "mean_batch_ms": 25.083821333391825,
              "std_batch_ms": 0.4055006272669166,
              "ms_per_img": 0.39193470833424726,
              "imgs_per_s": 2551.4453778540746,
              "peak_vram_gb": 0.28883838653564453
            }
          },
          "inference_quick": {
            "b1_ms_per_img": 11.910581999945862,
            "b1_imgs_per_s": 83.95895347553507,
            "b64_ms_per_img": 0.39193470833424726,
            "b64_imgs_per_s": 2551.4453778540746
          }
        },
        "raw": {
          "dataset": "THOCT",
          "root": "D:\\AIUB\\DSP\\Code\\Datasets\\THOCT1800\\THOCT1800_CLEAN_SHAONLY",
          "classes": [
            "AMD",
            "DME",
            "NOR"
          ],
          "model": "deit_small_distilled_patch16_224",
          "peft": "Manual LoRA into qkv (frozen backbone)",
          "lora": {
            "r": 8,
            "alpha": 16,
            "dropout": 0.1,
            "merged_for_timing": true
          },
          "params": {
            "total": 21816198,
            "trainable": 149766,
            "trainable_pct": 0.6864899190958937
          },
          "storage": {
            "best_model_path": "runs\\THOCT\\deit_small_lora_frozen_3c\\20251224-151457\\best_model.pth",
            "adapter_only_enabled": true,
            "adapter_only_bytes": 608249,
            "adapter_only_mb": 0.5800714492797852
          },
          "training": {
            "epochs_ran": 47,
            "best_val_loss": 0.29212614802213815,
            "best_val_macro_f1": 1.0,
            "total_train_time_sec": 91.92279839515686,
            "mean_epoch_time_sec": 1.7349390171943826,
            "peak_train_vram_gb": 1.748227596282959
          },
          "test_uncalibrated": {
            "acc": 0.9961538461538462,
            "macro_f1": 0.996144374240854,
            "macro_auc": 0.9999327731092437,
            "ece": 0.06486714207209071,
            "nll": 0.08280275762081146,
            "brier": 0.01385067434951556
          },
          "test_temp_scaled": {
            "enabled": true,
            "T": 0.3051670789718628,
            "ece": 0.003800139060387231,
            "nll": 0.037936434149742126,
            "brier": 0.007690866678941479
          },
          "inference_benchmark": {
            "latency_batch1": {
              "batch": 1,
              "mean_batch_ms": 11.910581999945862,
              "std_batch_ms": 0.9670862307587677,
              "ms_per_img": 11.910581999945862,
              "imgs_per_s": 83.95895347553507,
              "peak_vram_gb": 0.10202169418334961
            },
            "throughput_batchN": {
              "batch": 64,
              "mean_batch_ms": 25.083821333391825,
              "std_batch_ms": 0.4055006272669166,
              "ms_per_img": 0.39193470833424726,
              "imgs_per_s": 2551.4453778540746,
              "peak_vram_gb": 0.28883838653564453
            }
          }
        }
      }
    ]
  },
  "errors": []
}